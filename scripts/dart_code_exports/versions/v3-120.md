# Dart-Code v3-120

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.120.1 _2025-10-21_

  * [#5717](https://github.com/Dart-Code/Dart-Code/issues/5717): The Flutter Widget Preview is now enabled for the latest Flutter beta by default, without needing the `experimentalFlutterWidgetPreview` flag.

  > **#5717**: Remove requirement for experiment flag for Widget Preview gated on Flutter version with important fixes `is enhancement` `in flutter` `relies on sdk changes` `in flutter widget preview`
  > Currently we only show the widget preview if `dart.experimentalFlutterWidgetPreview` is set _and_ `flutterCapabilities.supportsWidgetPreview` (Flutter SDK is >= 3.36.0-1).
  > 
  > We should remove the requirement for the experiment flag for a version of the SDK that has all the fixes we think are necessary before showing this by default (by implementing a new capability `flutterCapabilities.supportsWidgetPreviewByDefault`).
  > 
  > I think https://github.com/flutter/flutter/pull/175783 is the most significant fix, so we could gate it on the version that lands in, which would mean any subsequent beta branch would have it enabled by default (@bkonyi - does this seem good to you, or are there any other changes/fixes you think we should require?).
  > 
  > (fyi @jwren @anderdobo)

  * [#5672](https://github.com/Dart-Code/Dart-Code/issues/5672): The Flutter Widget Preview icon has been updated to better match other Flutter sitebar icons.

  > **#5672**: Update the icon for the Widget Preview when shown in sidebar `is enhancement` `in flutter` `in flutter widget preview`
  > Splitting this from https://github.com/Dart-Code/Dart-Code/issues/5649 since it won't make the upcoming release that includes the initial preview support.
  > 
  > Currently we're just reusing the Flutter icon, but we should have a specific icon for Widget Preview.
  > 
  > (@elliette has put in a request for an icon for this to use consistently across tools)




# v3.120.0 _2025-09-30_

## Flutter

  * [#5713](https://github.com/Dart-Code/Dart-Code/issues/5713): When downloading the Flutter SDK through the extension, the File Dialog now defaults to the users home directory.

  > **#5713**: When downloading Flutter SDK, consider defaulting to putting it into the user's HOME `is enhancement` `in flutter`
  > I noticed that the "file chooser" that pops up, for the user to select where to put the Flutter SDK, can be "anywhere" and often less than ideal location. For example, it opened up a directory deep inside my project.
  > 
  > It would be awesome if, when the user chooses "Download SDK", that the File Chooser opens up default to their Home Directory. That way, flutter is put into $HOME as a reasonable default.
  > 
  > This is on a Mac, BTW.

  * [#5711](https://github.com/Dart-Code/Dart-Code/issues/5711): The **Dart: Add Dart SDK to PATH** and **Flutter: Add Flutter SDK to PATH** commands (and associated actions during the Flutter SDK download) are now available on both Mac and Linux (for Bash and Zsh) in addition to Windows.

  > **#5711**: Support "Add to PATH" for Linux for known shells `is enhancement` `in flutter` `in commands`
  > The fix for https://github.com/Dart-Code/Dart-Code/issues/4612 on macOS probably would work fine for Linux too.




## Testing

  * [#5729](https://github.com/Dart-Code/Dart-Code/issues/5729)/[#5727](https://github.com/Dart-Code/Dart-Code/issues/5727): A new setting `dart.experimentalTestTracking` enables tracking of tests within files. This should improve the reliability of test gutter icons and the “Go to Test” commands for tests that are not discoverable statically (for example dynamic tests, or those using `pkg:test_reflective_loader`). This will be enabled by default in a future release.

  > **#5729**: Add experimental test tracking `is enhancement` `in testing`
  > Release notes placeholder for the preview flag that enables new test tracking as a solution towards https://github.com/Dart-Code/Dart-Code/issues/5668 (since that issue will be bumped to a future release when the flag is removed).

  * [#5721](https://github.com/Dart-Code/Dart-Code/issues/5721): Code coverage is no longer collected for other packages that contain the name of the package being tested (for example if your app is named `app`, coverage will not be collected for `pkg:app_links`).

  > **#5721**: Code coverage is collected for dependencies that include the name of the app in their names `is bug` `in testing` `in coverage`
  > When I click "run tests with coverage" in VS Code, the resulting coverage pane shows coverage for some (apparently random) flutter library files, instead of for my code. See screenshot below.
  > 
  > If I run `flutter test --coverage` on the command line, then I get a `lcov.info` file which correctly reports coverage for my code, so this isn't a general issue with code coverage for my project; the issue is specific to the VS Code coverage facility in the dart/flutter extensions.
  > 
  > As far as I know my flutter project is totally vanilla. I'm running v3.118 of the dart/flutter extensions and v1.104.1 of VS Code. 
  > 
  > _Screenshot of the coverage pane. The 3 files displayed are library files, not my code.  Why it picks these 3 particular library files I do not know._

  * [#5706](https://github.com/Dart-Code/Dart-Code/issues/5706): Code coverage is now correctly collected when your package name in `pubspec.yaml` does not match the name of the folder the package resides in.

  > **#5706**: Code covarage isn't collected if the packages folder name does not match the package name in pubspec.yaml `is bug` `in testing`
  > Since v3.118 (I'm at v3.118.1 now), my project lost the ability to generate code coverage in Flutter projects. I'm pretty sure that before that version, it worked. Unfortunately, with that update, I also updated Flutter to 3.35.
  > 
  > I created the following log file which I redacted, hoping it will help to pin down the issue.
  > 
  > I'm selecting a single test file, clicking the coverage icon.
  > 
  > I'd expect code coverage for that file, but don't get any.
  > 
  > ```
  > !! ⚠️ PLEASE REVIEW THIS LOG FOR SENSITIVE INFORMATION BEFORE SHARING ⚠️ !!
  > Dart Code extension: 3.118.1
  > Flutter extension: 3.118.0 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: mac 1.104.0
  > 
  > Workspace type: Flutter (LSP)
  > Workspace name: ...
  > 
  > Dart (3.9.2): /Users/sma/Work/flutter/bin/cache/dart-sdk
  > Flutter (3.35.3): /Users/sma/Work/flutter (No device)
  > 
  > ...
  > 
  > _(truncated)_

  * [#5693](https://github.com/Dart-Code/Dart-Code/issues/5693)/[#5696](https://github.com/Dart-Code/Dart-Code/issues/5696): Changes to test files made externally (for example by terminal-based coding agent) are now detected and the Test Explorer updated.

  > **#5693**: New/renamed/deleted unit test files created externally do not update the Test Runner `is bug` `in testing`
  > **Describe the bug**
  > If an external tool (like some AI tool) creates a new unit test file, it does not appear in the Testing tab automatically.
  > 
  > **To Reproduce**
  > 
  > 1. Create a new app
  > `flutter create flutter_app_3_35_3`
  > 2. Open the project folder in VS Code and open the Testing tab to see tests.
  > 3. In the integrated Terminal, create a new test file:
  > `touch test/foo_test.dart`
  > 
  > **Expected behavior**
  > The new test file appears in the Testing tab.
  > 
  > **Actual behavior**
  > The new test file does not appear in the Testing tab until you open it in the editor first.
  > 
  > **Environment**
  > Operating System and version: macos / Version 15.5 (Build 24F74) darwin-arm64
  > VS Code version: mac 1.103.2
  > Dart Code extension: 3.118.1
  > Flutter extension: 3.118.0
  > Dart/Flutter SDK version: Dart 3.9.2 / Flutter 3.35.3

  * [#5682](https://github.com/Dart-Code/Dart-Code/issues/5682): A small delay has been added before showing “Starting debug session…” to avoid the notification appearing briefly for debug sessions that start quickly.

  > **#5682**: Don't show "Starting debug session…" so aggressively when running many test files `is enhancement` `in testing`
  > **Describe the bug**
  > 
  > Launching an intensive serie of tests, a pop-up says 'Launching Debug Session' between each
  > file it seems, maybe group.
  > 
  > This is new behavior that slowdown the process by at least 20 times making checks impossible from the IDE.
  > 
  > **Expected behavior**
  > Fast as previously. One debug session only?
  > 
  > **Please complete the following information:**
  > 
  > Dart Code extension: 3.118.1
  > Flutter extension: 3.118.0 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: mac 1.103.2
  > 
  > Workspace type: Dart, Flutter (LSP)
  > 
  > Dart (3.10.0-75.1.beta): 
  > Flutter (3.36.0-0.4.pre):




## Commands

  * [#5684](https://github.com/Dart-Code/Dart-Code/issues/5684): A new command **Flutter: Clean All Projects** cleans all Flutter projects in the workspace.

  > **#5684**: Add “Flutter: Clean All Projects” command `is enhancement` `in commands`
  > Currently, we have **Flutter: Clean Project**, which only runs `flutter clean` on the currently selected working folder in the workspace.
  > 
  > However, when you have multiple folders in a workspace, there is no way to clean all their build files at once.
  > 
  > **Suggestion:** Add a **Flutter: Clean All Projects**, similar to the existing **Flutter: Get Packages For All Projects**.

  * [#4696](https://github.com/Dart-Code/Dart-Code/issues/4696): Commands related to Dart Observatory are now hidden for Dart SDKs since 3.9 (when Observatory was removed).

  > **#4696**: Hide Observatory commands for SDKs that do not support it `is enhancement` `in commands`
  > When observatory is completely removed, we should use that SDK version number as a signal to hide the command so it's not in the palette.




## Editor

  * [#5694](https://github.com/Dart-Code/Dart-Code/issues/5694)/[#5695](https://github.com/Dart-Code/Dart-Code/issues/5695): Ctrl+Click on `package:` links in terminal/documents will no longer sometimes jump to the wrong version of a package.

  > **#5694**: Document Links may link to the wrong version of a package `is bug` `in editor`
  > While looking at #5692, I realised that DocumentLinks would also just find the "first" version of a `package:` URI to link to, which could be incorrect if a workspace has projects that reference different versions of the same dependency.
  > 
  > We should prefer to look at the package map for the project containing the source file, and only fall back to finding another match if there isn't one.

  * [#5692](https://github.com/Dart-Code/Dart-Code/issues/5692)/[#5698](https://github.com/Dart-Code/Dart-Code/issues/5698): Ctrl+Click on `package:` links will now show a Peek window showing multiple results when there are multiple versions of a package in the workspace and the link had no context to narrow to a specific version.

  > **#5692**: Ask which file to open if `package:` uri has multiple matches from a terminal Ctrl+Click `is enhancement` `in editor`
  > **Is your feature request related to a problem? Please describe.**
  > If you have two projects in a folder/VS Code workspace, and they both depend on the same package for different versions (or if any is the actual package and the other is from pub), we are currently assuming one of the `package:` uris to open.
  > 
  > **Describe the solution you'd like**
  > I'd like to be asked what file to open.
  > 
  > **Describe alternatives you've considered**
  > Knowing which file it refers to and opening it manually.
  > 
  > **Additional context**
  > 1. Clone https://github.com/fmorschel/package_uri_repro
  > 2. Pub get
  > 3. Run `repro/bin/dart` on the terminal and `Ctrl` + `Click` the URI.




## Debugging

  * [#5712](https://github.com/Dart-Code/Dart-Code/issues/5712): The **Debug: Attach to Dart Process** command now makes it clearer that a port number can be provided instead of a full URL.

  > **#5712**: Attach to Dart Process should be clear we can place only the port `is enhancement` `in debugging`
  > **Is your feature request related to a problem? Please describe.**
  > I was trying to debug a DAS fix and running a project with `analyzerVmServicePort` set. Once I tried writing `localhost:1234`, it would not connect.
  > 
  > **Describe the solution you'd like**
  > Change the placeholder text to make this clearer.
  > 
  > **Describe alternatives you've considered**
  > Mentioning the need for `http:`/`https:` scheme.
  > 
  > **Additional context**

  * [#5670](https://github.com/Dart-Code/Dart-Code/issues/5670): The current open file is no longer used as a hint for what to launch when an explicit launch config is selected from a different workspace folder.

  > **#5670**: Wrong project is launched when the selected launch config is does not explicitly contain program/cwd and the open file is from another workspace folder `is bug` `in debugging`
  > **Describe the bug**
  > Pressing F5 with a vscode workspace launch settings that points to a different project (within the workspace) opens that project's launch settings file and doesn't run.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Clone https://github.com/FMorschel/workspace
  > 2. Open `this.code-workspace`
  > 3. Open `package/lib/package.dart`
  > 4. Select "APP" option for launch
  > 5. Press `F5`
  > 
  > **Expected behavior**
  > For the "hello world" to launch on the web (the only platform on the repo), but instead, it does as explained above. 
  > 
  > **Please complete the following information:**
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.117.20250813
  > Flutter extension: 3.117.20250731 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: win 1.103.2
  > 
  > Workspace type: Dart, Flutter (LSP) (Multiroot)
  > Workspace name: this (Workspace)
  > 
  > _(truncated)_

  * [#5397](https://github.com/Dart-Code/Dart-Code/issues/5397): An issue with isolates appearing as “paused on entry” even if they’re not paused has been fixed in the upcoming release of VS Code.

  > **#5397**: Isolates appear as "paused on entry" even if they're not paused `is bug` `in debugging` `fixed in vs code`
  > **Describe the bug**
  > 
  > When spawning new isolates at the start of an application, these isolates are mistakenly viewed as "paused on entry" in the call stack of the debugging view.
  > 
  > ```dart
  > import 'dart:async';
  > import 'dart:isolate';
  > 
  > void main() async {
  >   final isolates = [];
  > 
  >   for (var i = 0; i 
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.102.0
  > Flutter extension: 3.102.0 (not activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: mac 1.96.3
  > 
  > Workspace type: Dart (LSP)
  > Workspace name: vscode_startup_issue
  > 
  > Dart (3.6.1): /opt/homebrew/Cellar/dart/3.6.1/libexec
  > Flutter (3.27.2): /Users/simon/fvm/versions/stable (No device)
  > 
  > ```
  > 
  > Output from 'dart info'
  > 
  > `/opt/homebrew/Cellar/dart/3.6.1/libexec/bin/dart info`
  > 
  > If providing this information as part of reporting a bug, please review the information
  > below to ensure it only contains things you're comfortable posting publicly.
  > 
  > #### General info
  > 
  > _(truncated)_




## Dart Tooling Daemon (DTD)

  * [#5725](https://github.com/Dart-Code/Dart-Code/issues/5725)/[#5726](https://github.com/Dart-Code/Dart-Code/issues/5726): The `navigateToCode` editor service is now registered with DTD and can be called by other DTD clients to navigate the editor to a specific file/line/col.

  > **#5725**: Implement navigateToCode editor service `is enhancement` `in dtd` `in flutter widget preview`
  > Seems we've never implemented this:
  > 
  > https://github.com/dart-lang/sdk/blob/main/pkg/dtd_impl/dtd_common_services_editor.md#navigatetocode
  > 
  > @bkonyi needs it for Widget Preview

  * [#5718](https://github.com/Dart-Code/Dart-Code/issues/5718)/[#5720](https://github.com/Dart-Code/Dart-Code/issues/5720): The `getActiveLocation` editor service is now registered with DTD and can be used to get the open file/line/col. This complements the existing `activeLocationChanged` event stream.

  > **#5718**: Implement the `getActiveLocation()` Editor service over DTD `is enhancement` `in dtd`
  > See https://github.com/dart-lang/sdk/issues/61538




## Cloud IDEs

  * [#5680](https://github.com/Dart-Code/Dart-Code/issues/5680): Embedded DevTools pages no longer intermittently fail with errors like “Failed to connect to DTD” or “Failed to connect to VM Service” when running in some cloud IDEs like Firebase Studio.

  > **#5680**: Add code for authentication from the DevTools iframe to enable access to web socket connections for VM Service and DTD `is bug fix` `on cloud ide`
  > …o enable access to web socket connections for VM Service and DTD.
  > 
  > 
  > - These changes were tested in FS and was able to open DevTools all the tries. No issues with VM Service connection or the DTD connection
  > - Did not remove the delay you added before testing.

  * [#5158](https://github.com/Dart-Code/Dart-Code/issues/5158): All embedded DevTools pages should now work when running in some cloud IDEs like Firebase Studio.

  > **#5158**: Sidebar DevTools not working in IDX/Firebase Studio `is bug` `in flutter sidebar`
  > **Describe the bug**
  > When opening a remote VSCode or CodeOSS Workspace, the Flutter DevTools in the sidebar fails to load. It appears to be assuming it has access to a server on localhost, which is not the case for remote workspaces.
  > 
  > **To Reproduce**
  > This should be reproducible in any remote workspace, but is trivial to reproduce using IDX.
  > 
  > Steps to reproduce the behavior:
  > 1. Create a new workspace in IDX
  > 2. Click on the Flutter extension icon in the activity bar
  > 3. Wait for the "Flutter Sidebar" to load with the failure shown below
  > 
  > **Expected behavior**
  > The Flutter Sidebar functionality should be shown for remote workspaces, or the section should not be visible if the functionality cannot be supported remotely.
  > 
  > **Screenshots**
  > 
  > ![Screenshot 2024-06-27 at 2 05 34 PM](https://github.com/Dart-Code/Dart-Code/assets/109253501/c5fe01f7-ae11-481e-81c7-24f531696c2d)
  > 
  > **Please complete the following information:**
  > 
  > You can run the **Dart: Collect Diagnostic Information*
  > 
  > _(truncated)_

  * [#5683](https://github.com/Dart-Code/Dart-Code/issues/5683): The extension now starts up faster when running in Firebase Studio.

  > **#5683**: Remove service action delay for Firebase Studio `is enhancement` `on cloud ide`
  > Now we're using iframes to force authentication, this may be unnecessary. In my testing, I'm not hitting any issues without it.




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

### Widget Preview

Several improvements have been made to the integration with the Widget Preview functionality (which currently requires the Flutter `master` branch).

  * [#5722](https://github.com/Dart-Code/Dart-Code/issues/5722): The **Flutter: Show Widget Preview** command now makes the view visible even if run during startup.

  > **#5722**: "Show Widget Preview" command does not make view visible `is bug` `in commands` `in flutter widget preview`
  > I ran this command, and the sidebar did not change to show this view.

  * [#5702](https://github.com/Dart-Code/Dart-Code/issues/5702)/[#5715](https://github.com/Dart-Code/Dart-Code/issues/5715): Theme information from VS Code is now passed through to the Widget Preview.

  > **#5702**: Pass theme colours to Widget Preview on querystring in the same format as DevTools `is enhancement` `in flutter` `in flutter widget preview`
  > To ensure the widget preview fits in whether it's in the sidebar or editor tab, we should pass the bg/fg colours on the querystring. They should be in exactly the same format as embedded DevTools pages (which I think is 6-digit hex code, with the hash being optional - since VS Code's URI class has encoding issues).

  * [#5691](https://github.com/Dart-Code/Dart-Code/issues/5691): Widget preview processes are no longer leaked on Windows.

  > **#5691**: Widget Preview leaks processes (on Windows?) `is bug` `in flutter` `in flutter widget preview`
  > Originally reported at https://github.com/flutter/flutter/issues/175002 thinking it was a Flutter issue, but I think it's actually just the usual thing of terminating the shell process not terminating the spawned process (the reason we have record `pid`s from so many processes).
  > 
  > The PID was added in https://github.com/flutter/flutter/pull/175003 so we need to handle the new event and record the PID.




### Misc

  * [#5600](https://github.com/Dart-Code/Dart-Code/issues/5600): A new setting `dart.inlayHints` has been added to control which Inlay Hints are enabled (requires Dart 3.10)

  > **#5600**: Add dart.inlayHints configuration to manifest `is enhancement` `in editor` `relies on sdk changes`
  > Implemented via https://github.com/dart-lang/sdk/issues/60326. Needs the settings adding here so they show up in the settings UI/JSON auto-complete etc.

  * [#5661](https://github.com/Dart-Code/Dart-Code/issues/5661): Devices/platforms that are not currently enabled can once again be enabled from the Flutter Sidebar.

  > **#5661**: Unable to enable new device/platforms from the Flutter sidebar `is bug` `relies on sdk changes` `in flutter sidebar`
  > Sometimes you only want to update the Android folder to a new version. In that case, you delete the old one and execute:
  > 
  > ```bash
  > flutter create --platforms android .
  > ```
  > 
  > This recreates the Android folder with the latest bits and pieces.
  > It would be a good addition to the visual panel or accessible via **Ctrl + P**.
  > 
  > This should be expanded to create Windows/iOS/Linux/Web folders as well, with their corresponding events.

  * [#5652](https://github.com/Dart-Code/Dart-Code/issues/5652): Code completion for overriding methods once again sets the cursor position after completion.

  > **#5652**: Override completions do not automatically set selection `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > Since today's release, this test is failing:
  > 
  > ```
  >   1) completion_item_provider
  >        inserts full text for overrides:
  > 
  >       AssertionError [ERR_ASSERTION]: actual: 8:52-8:52 () vs expected: 8:25-8:51 (throw UnimplementedError())
  > 
  > false !== true
  > 
  >       + expected - actual
  > 
  >       -false
  >       +true
  >       
  >       at ensureTestSelection (src/test/helpers.ts:993:9)
  >       at ensureTestContentWithSelection (src/test/helpers.ts:1004:2)
  >       at Context. (src/test/dart/providers/completion_item_provider.test.ts:136:3)
  > ```
  > 
  > It appears that after completing this code, the selection is just at the end of the `throw UnimplementedError()` instead of selecting it:

