# Dart-Code v3-114

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.114.2 _2025-07-02_

  * [#5573](https://github.com/Dart-Code/Dart-Code/issues/5573): Fixed an error during extension activation when using VS Code 1.100.

  > **#5573**: Failure to activate on VS Code v1.100 `is bug`
  > @srawlins hit an issue with the extension activating today, which had an error very similar to https://github.com/Dart-Code/Dart-Code/issues/5570 but for the MCP server registration (not the lmTools registration).
  > 
  > The issue is that if the `registerMcpServerDefinitionProvider` API exists, we always call it, and we only look at the MCP flag within the provider (and return an empty set), which is to avoid telling VS Code in the manifest that we will register a provider and then not doing so.
  > 
  > However, on VS Code 1.100, this API _exists_ but throws because it only proposed (and we're not allowed to use propsed APIs here).
  > 
  > So, we need a similar try/catch around this call.
  > 
  > This didn't occur for Firebase Studio because it's an older VS Code yet, and that didn't have the API at all.




# v3.114.1 _2025-07-02_

  * [#5570](https://github.com/Dart-Code/Dart-Code/issues/5570)/[#5569](https://github.com/Dart-Code/Dart-Code/issues/5569): Fixed errors during extension activation when using older versions of VS Code (such as 1.94 that is currently used on Firebase Studio).

  > **#5570**: Activating extension 'Dart-Code.dart-code' failed: Extension 'Dart-Code.dart-code' CANNOT use API proposal: lmTools `is bug`
  > Seen on Firebase Studio with v3.114.0:
  > 
  > > workbench.js:631 Activating extension 'Dart-Code.dart-code' failed: Extension 'Dart-Code.dart-code' CANNOT use API proposal: lmTools.
  > Its package.json#enabledApiProposals-property declares: [] but NOT lmTools.
  >  The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api Dart-Code.dart-code.




# v3.114.0 _2025-07-01_

## Flutter

  * [#5541](https://github.com/Dart-Code/Dart-Code/issues/5541): The `dart.previewHotReloadOnSaveWatcher` setting that allows triggering Hot Reload for external file modifications will no longer trigger while a Flutter app is still building/starting which could lead to the error â€œorg-dartlang-app:/web_entrypoint.dart does not existâ€ when using `package:flutter_localizations`.

  > **#5541**: previewHotReloadOnSaveWatcher triggers Hot Reload requests during builds, which can result in errors `is bug` `in flutter` `in debugging`
  > See https://github.com/flutter/flutter/issues/169391#issuecomment-2958208626 for some context.
  > 
  > If you enable this setting, during the launch of an app we send Hot Reload requests, and they're so early that it appears to stop the app from launching:
  > 
  > ![Image](https://github.com/user-attachments/assets/d9dfbfbf-a109-4771-a58a-35d0bca73e16)
  > 
  > We should skip sending any Hot Reload requests to debug sessions that are not fully started.

  * [#5553](https://github.com/Dart-Code/Dart-Code/issues/5553): Setting `"dart.hotReloadProgress": "statusBar"` now correctly shows Flutter hot reload progress in the status bad instead of toast notifications.

  > **#5553**: "dart.hotReloadProgress": "statusBar" doesn't work `is bug` `in flutter` `in debugging`
  > I added this to my settings for a Flutter app:
  > 
  > ```
  > "dart.hotReloadProgress": "statusBar"
  > ```
  > 
  > However I still see toast notifications.

  * [#5552](https://github.com/Dart-Code/Dart-Code/issues/5552): Saving multiple files with **Save All** should no longer result in multiple â€œHot Reloadingâ€¦â€ notifications (except where delays in save actions result in different files being saved at different times).

  > **#5552**: "Save All" results in multiple "Hot Reloading..." notifications `is bug` `in flutter` `in debugging`
  > **Is your feature request related to a problem? Please describe.**
  > If you have multiple (n) files modified, then selecting `Save All Files` in VS Code triggers n hot reload notifications (although it's just one hot reload log). The confusing part is that the notifications do not disappear at once, so it suggests that multiple processes are kicked off. If there's a single request then we're probably fine and this issue can be closed.
  > 
  > https://github.com/user-attachments/assets/508d7c11-837f-4109-bbce-7fb49366e82b
  > 
  > **Describe the solution you'd like**
  > When I choose to save all files at once, it should only trigger single hot reload.
  > 
  > **Describe alternatives you've considered**
  > Using command line and pressing `r` for hot reload after saving files.
  > 
  > **Additional context**
  > 
  > - running on iOS simulator
  > - extension version 3.112.0
  > - Flutter 3.29.3




## Editor

  * [#5562](https://github.com/Dart-Code/Dart-Code/issues/5562): The error â€œUnknown Outline item: TYPE_ALIASâ€ no longer appears in the developer console when editing files with generic type aliases.

  > **#5562**: "Unknown Outline item: TYPE_ALIAS" `is bug` `in editor`
  > I saw this while running tests in DevTools:
  > 
  > ![Image](https://github.com/user-attachments/assets/a04f01c2-3252-4f24-beca-9f7b48d29709)




## Testing

  * [#5544](https://github.com/Dart-Code/Dart-Code/issues/5544): Gutter test markers for tests that use `package:test_reflective_loader` should no longer jump back to incorrect locations when modifying files.

  > **#5544**: Line info for `test_reflective_loader` package tests can easily get out of sync `is bug` `in testing`
  > From https://github.com/Dart-Code/Dart-Code/issues/5529#issuecomment-2955815489:
  > 
  > > > And the current UI, although it does work most of the time, if you add some lines, I've seen them get out of sync (interestingly, the "expect" error labels that show up never do, they're always in the right place) from the method declaration.
  > > 
  > > I don't know how often this happens, but I'd be interested in an issue for this - because if this happens with those markers, it would _also_ happen to the CodeLens if we switched them over to using the test model data ðŸ˜”
  > 
  > 1. In Dart SDK, open `pkg\analysis_server\test\services\completion\dart\location\dart_doc_test.dart` and run all tests.
  > 2. Add a new line before the first test inside the reflective test class (and wait just a small bit), see that all current checks stay in place while the new line is added:
  > 
  > ![Image](https://github.com/user-attachments/assets/5858edd5-6be0-4d48-ab7f-fc5ccd25ce2c)
  > 
  > _(truncated)_

  * [#5534](https://github.com/Dart-Code/Dart-Code/issues/5534): When using the upcoming VS Code v1.102, failed tests will now show the test path in the Test Results tree just like passing tests do.

  > **#5534**: Test error hides path to file on Test Results tab `is enhancement` `fixed in vs code` `in testing`
  > **Describe the bug**
  > When a test errors, the Test Results tab stops showing the path to the file and that can make sibling-classes tests harder to debug to find which one broke.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Clone https://github.com/FMorschel/test_repro
  > 2. Run the dart tests
  > 
  > **Expected behavior**
  > The path to the file should show up on the Test Results tab even when errors occur.
  > 
  > **Screenshots**
  > 
  > ![Image](https://github.com/user-attachments/assets/82e80c83-f1d7-4142-88fb-5e11d50083fc)
  > 
  > The same tests in Python (pytest) and JS (jest):
  > 
  > ![Image](https://github.com/user-attachments/assets/c95a23df-c0a1-4432-9ca0-3045ffe98cec)
  > 
  > ![Image](https://github.com/user-attachments/assets/5ec0959c-f024-4dd8-b661-536ca7267da1)
  > 
  > **Please complete the following information:**
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.113.20250602
  > Flutter extension: 3.113.20250603 (not activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: win 1.100.3
  > 
  > _(truncated)_




## Debugger

  * [#5520](https://github.com/Dart-Code/Dart-Code/issues/5520): Itâ€™s now possible to specify `emulatorId` instead of `deviceId` in a launch configuration. This will automatically be mapped to the correct `deviceId` during launch, and if the emulator is not already running it will first be started.

  > **#5520**: Support auto-launching emulators from launch.json `is enhancement` `in debugging`
  > If you have a launch config with a hard-coded device ID (possibly using https://github.com/Dart-Code/Dart-Code/issues/5516), it'll only work if the emulator device exists. We should support an additional field `emulatorId` that can be used to auto-launch an emulator and use that (by looking up the device with that emulator ID).
  > 
  > (we'd need a second field because emulator and device IDs are not the same)

  * [#5535](https://github.com/Dart-Code/Dart-Code/issues/5535): Itâ€™s now possible to explicitly set a `debuggerType` field on a launch configuration. The correct debugger type should be selected automatically so needing to use this may indicate a bug (outside of some particular cases such as other extensions starting Dart attach debug sessions within Flutter projects).

  > **#5535**: Allow debugger `debuggerType` to be provided explicitly by a launch configuration `is enhancement` `in debugging`
  > **Describe the bug**
  > A clear and concise description of what the bug is.
  > 
  > I am developing a VSCode extension that will auto-attach a Dart debug session. The program that I am trying to run will always be a Dart application.
  > 
  > If the workspace contains a root `pubspec.yaml` file that references Flutter, the `debuggerType` is forced to `DebuggerType.Flutter`.
  > 
  > **Expected behavior**
  > A clear and concise description of what you expected to happen.
  > 
  > If I supply
  > ```ts
  >     const attached = await vscode.debug.startDebugging(workspace, {
  >         name: debugSessionName,
  >         request: "attach",
  >         type: "dart",
  >         vmServiceUri: debugUrl,
  >         debuggerType: 0 // DebuggerType.Dart
  >     });
  > ```
  > 
  > I expect the `debuggerType` to remain as `DebuggerType.Dart`
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.113.20250602
  > Flutter extension: 3.113.20250603 (activated)
  > 
  > App: Cursor
  > App Host: desktop
  > Version: mac 1.96.2
  > 
  > Workspace type: Dart (LSP)
  > Workspace name: project
  > 
  > _(truncated)_




## Commands

  * [#5563](https://github.com/Dart-Code/Dart-Code/issues/5563): Saving a `pubspec.yaml` in a Pub Workspace where the root folder is not open within the VS Code workspace will no longer prompt asking which project to fetch packages for.

  > **#5563**: Unexpected prompt to select a package when saving pubspec.yaml for Pub Workspaces if root is outside of open folders `is bug` `in commands`
  > In this Flutter workspace, when I save `bots/pubspec.yaml` I'm prompted to run pub get in which folder. This should be automatic for the project where I just saved!
  > 
  > ![Image](https://github.com/user-attachments/assets/d330ca20-9ed3-4e00-b489-fb89adbedd65)

  * [#5533](https://github.com/Dart-Code/Dart-Code/issues/5533): The **Change where DevTools appears** command is now available from the overflow menu for DevTools panels embedded as editors (in addition to the sidebar where it showed previously).

  > **#5533**: Add "Change where DevTools appears" command to embedded non-sidebar panels `is enhancement` `in commands` `in devtools`
  > When DevTools is hosted in the sidebar, we show this command:
  > 
  > ![Image](https://github.com/user-attachments/assets/830e7569-0029-468e-adf8-268019dc079d)
  > 
  > Which opens the setting for changing the location.
  > 
  > We should also show it for non-sidebar embedded panels.

  * [#5502](https://github.com/Dart-Code/Dart-Code/issues/5502): The **Add Dependency** command will now allow selecting which projects to add the dependency to, with the project for the active file pre-selected, instead of just automatically adding to the project for the active file.

  > **#5502**: Automatically selecting a project to add a dependency to from the open file is not obvious, should instead show a pick-list with it pre-selected `is enhancement` `in commands`
  > **Describe the bug**
  > I have a `packages` folder with some flutter and dart packages. When I try to add a new dependency I can't select where I want to add this dependency (see example on the attached screenshot).
  > 
  > **Expected behavior**
  > To have a choice where I can add a new dependency as on the screenshot
  > 
  > **Screenshots**
  > 
  > **Please complete the following information:**
  > 
  > You can run the **Dart: Collect Diagnostic Information** command from the VS Code command palette (`F1`) to easily capture this information or provide it manually.
  > 
  >  - macOS 13.5.1
  >  - VS Code version: 1.99.3
  >  - Dart extension version: 3.110.0
  >  - Dart/Flutter SDK version: 3.7.2/3.29.3
  >  - Target device (if the issue relates to Flutter debugging): -

  * [#5513](https://github.com/Dart-Code/Dart-Code/issues/5513): When using the **Restart Analysis Server** command, a log file of recent events will now be recorded and a notification shown with a button to open this log. If you find yourself using this command frequently, please file a bug with the log file.

  > **#5513**: When using the "Restart Analysis Server" command, record a log with some diagnostic info `is enhancement`
  > See https://github.com/dart-lang/sdk/issues/60540#issuecomment-2877581881
  > 
  > Some users use this command periodically but not enough to get a prompt encouraging filing a bug. It's also difficult to collect info after the fact (and it may not be appropriate to try to debug while you're in the middle of something and the analyzer breaks).
  > 
  > We should have this command automatically record some logs - for example the last traffic from the analyzer and the usual log header info. Each file should be new (with a timestamp in the name) to avoid any overwriting. This way if someone is using this command they may be able to provide or review these log files for possible patterns.
  > 
  > (ideally we'd get the instrumentation log, because it contains watch events and server-side errors.. but I don't think there's a good way to do this).




## Dart Tooling Daemon

  * [#5526](https://github.com/Dart-Code/Dart-Code/issues/5526)/[#5527](https://github.com/Dart-Code/Dart-Code/issues/5527): Debug sessions are now registered with DTD via the `registerVmService`/`unregisterVmService` methods when they are available.

  > **#5526**: Register VM Services with DTD using new registerVmService/unregisterVmService methods `is enhancement` `in dtd`
  > DTD has a new `ConnectedApp` service with `registerVmService` and `unregisterVmService` methods which we should use as debug sessions start/end (and for any existing debug sessions that exist when we see the service registered).
  > 
  > See https://github.com/dart-lang/sdk/issues/60540




## Misc

  * [#5536](https://github.com/Dart-Code/Dart-Code/issues/5536): The location of the `.dart_code` folder (which can be used for automatically launching/attaching debug sessions at startup) can now be overridden with the environment variable `DART_CODE_CONFIGURATION_PATH`.

  > **#5536**: Support overriding the location of the `.dart_code` folder with an environment variable `is enhancement`
  > With https://github.com/Dart-Code/Dart-Code/issues/5516 we added a way to have debug sessions automatically launched at startup, or when a special file was created.
  > 
  > For some uses of this, it would be better to keep it out of the tree (for example in the case where an IDE like Firebase Studio wants to use it to auto-connect to an existing session without polluting the users workspace with the temporary file).
  > 
  > One way to achieve this is to support an environment variable to override the location of this folder. For example:
  > 
  > ```
  > SET DART_CODE_CONFIGURATION_PATH=/tmp/xyz123/.dart_code
  > ```
  > 
  > Then when we load, we'll use this environment variable in place of `.dart_code/` when looking for (and setting up a watcher for) the auto-launch file.
  > 
  > _(truncated)_




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

  * [#5548](https://github.com/Dart-Code/Dart-Code/issues/5548): Some operations on local variables (such as Rename or Find References) no longer fail if the variable is in a folder that exists in the current workspace multiple times (for example because both a parent and child folder are explicitly added to the workspace).

  > **#5548**: Renaming a local variable does not update references in a workspace with overlapped analysis roots, depending on the paths `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > Rename only applied to first parameter declaration, when analysis server works in a specific configuration.
  > 
  > This bug is only seems to occur when sub package is VS Code WS folder and root folder is also VS Code WS folder and there is `analysis_options.yaml` file in sub package.
  > 
  > Removing `analysis_options.yaml` or root folder from VS Code workspace mitigates the issue.
  > 
  > **To Reproduce**
  > * Create pub workspace in project folder
  > * Create submodule in a subfolder
  > * Add subfolder and project folders as VS Code workspace folders
  > * Create analays_options.yaml in submodule
  > * Try to rename a symbol
  > 
  > Attaching example environment.
  > Open `test.code-workspace` and try to rename variable `a` in `main.dart`.
  > [dart_code_test.zip](https://github.com/user-attachments/files/20743089/dart_code_test.zip)
  > 
  > **Expected behavior**
  > Should work as normal.
  > 
  > **Screenshots**
  > 
  > ![Image](https://github.com/user-attachments/assets/fea19697-266c-4b9f-bb43-b9b8fd7bd8f5)
  > 
  > _(truncated)_

  * [#5547](https://github.com/Dart-Code/Dart-Code/issues/5547): Variables introduced by `for` loops and record destruction are now included in Inline Values.

  > **#5547**: Missing inline value for object/record pattern and for loops `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Is your feature request related to a problem? Please describe.**
  > Inline values show for parameters but not for pattern destruction blocks. This forces me to hover the assigned variable instead of simply looking at the value.
  > 
  > **Describe the solution you'd like**
  > When destructing the record (repro below) into `x` and `y`, and always in for loops, we should see the new declared/assigned variable value.
  > 
  > **Describe alternatives you've considered**
  > Hovering over the variable or adding to watch.
  > 
  > **Additional context**
  > 
  > Repro:
  > 
  > ```dart
  > class A {
  >   List list = [1, 2, 3];
  > 
  >   void m(int value, List records) {
  >     for (var x in list) { // B1 here, all parameters show
  >       print(value);  // B2 here, same as above
  >       print(x);
  >     }
  >     for (var (x, y) in records) {
  >       print(value); // B3 here, since the iterable above is not a getter, we see its value being used too
  >       x + y;
  >     }
  >   }
  > }
  > 
  > void main() {
  >   A().m(0, [(1, 2)]);
  > }
  > ```
  > 
  > _(truncated)_

  * [#5532](https://github.com/Dart-Code/Dart-Code/issues/5532): Lists inspected in the debugger at the top level (for example by hovering) are now paged in the same way as child fields which improves performance and avoids stalls for very large lists.

  > **#5532**: Hovering over very large lists makes debugging unresponsive because results are not paged `is bug` `in debugging` `relies on sdk changes`
  > **Describe the bug (and reproduction)**
  > 
  > Say you have this code:
  > 
  > ```dart
  > void main() {
  >   Uint8List data = Uint8List(268435456);
  >   foo(data);
  > }
  > 
  > void foo(Uint8List data) {
  >   print("hello data of size ${data.length}");
  > }
  > ```
  > 
  > and has a breakpoint on the `foo` call.
  > 
  > On the left under "Varaibles" you'll see "Uint8List (268435456 items)" and drop-downs breaks it into smaller chunks before eventually it requests 100 elements via a `variables` call with option `"count":100`. This works well.
  > 
  > If instead you place your mouse over the `data` variable in the source code you're in for a bad time because it requests without any `"count"` parameter and the VM then happily does what it was asked on all 268435456 elements - eventually (on my machine) running out of memory somewhere in `return elements.mapIndexed([...]).toList();` in `ProtocolConverter.convertVmInstanceToVariablesList`.
  > Until it fails (after a while) debugging is unresponsive, and the debugging session can't even be stopped (without
  > 
  > _(truncated)_

  * [#5499](https://github.com/Dart-Code/Dart-Code/issues/5499): The `dart.documentation` preference now only applies to requests that return multiple sets of documentation (for example Code Completion). This means single requests like Hovers will still always show documentation even if `dart.documentation` is set to `none` or `summary` (as is the default in remote workspaces).

  > **#5499**: When editing code remotely, dartdoc is not shown in hovers `is bug` `in remote` `relies on sdk changes`
  > Here I edit a file locally, and hover an identifier. I get the associated dartdoc in the pop-up
  > 
  > When I do the same in a remote folder I get the type, but no dartdoc:
  > 
  > Diagnostics from local window:
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.108.2
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: mac 1.99.3
  > 
  > Workspace type: Dart, Flutter (LSP)
  > Workspace name: blah
  > 
  > Dart (3.8.0-126.0.dev): /Users/sigurdm/projects/flutter/bin/cache/dart-sdk
  > Flutter (3.30.0-1.0.pre.266): /Users/sigurdm/projects/flutter (macOS (darwin/macos))
  > 
  > ```
  > 
  > Output from 'dart info'
  > 
  > `/Users/sigurdm/projects/flutter/bin/cache/dart-sdk/bin/dart info`
  > 
  > If providing this information as part of reporting a bug, please review the information
  > below to ensure it only contains things you're comfortable posting publicly.
  > 
  > #### General info
  > 
  > - Dart 3.8.0-126.0.dev (dev) (Thu Feb 20 20:02:14 2025 -0800) on "macos_arm64"
  > - on macos / Version 15.4.1 (Build 24E263)
  > - locale is en
  > 
  > #### Project info
  > 
  > _(truncated)_

  * [#5454](https://github.com/Dart-Code/Dart-Code/issues/5454): Inline Values are no longer shown in branches unless current execution is within that branch. This avoids showing values against code that was not executed.

  > **#5454**: Inline Values is not aware of conditional branches and may show for code that's not executed `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > For example here, the branch was not taken, but it's where we're showing the inline value:
  > 
  > ![Image](https://github.com/user-attachments/assets/7f77696f-5496-4c9b-b823-4f71e1e05b86)
  > 
  > There's no way the analysis server can know which code paths were taken, so we need to use some rules that aren't affected which branches are taken. That might leaving it as it is, or might mean excluding all branches (except the current one - although that itself may be risky because we don't know how reliable the "execution pointer" position we're given is).

  * [#4678](https://github.com/Dart-Code/Dart-Code/issues/4678): When adding/removing a breakpoint in a file, all other breakpoints in that file are no longer unverified and then re-verified resulting in flickering between grey/red states.

  > **#4678**: Breakpoints flicker as they are removed/re-added when breakpoints are added/removed `is bug` `in debugging` `relies on sdk changes`
  > Because we mark breakpoints as unverified initially now, and we delete/re-create them when anything changes (because VS Code just gives us a whole new set), there's a noticable flicker.
  > 
  > https://github.com/Dart-Code/Dart-Code/assets/21116742/daa2f555-2830-4fd7-8f21-7b00d4dc103c

  * [#5554](https://github.com/Dart-Code/Dart-Code/issues/5554): Triggering multiple Hot Reload requests in a short space of time no longer results in some requests failing with â€œBad state: StreamSink is bound to a stream.â€.

  > **#5554**: Bad state: StreamSink is bound to a stream `is bug` `in flutter` `in debugging` `relies on sdk changes`
  > While testing changes for https://github.com/Dart-Code/Dart-Code/issues/5552 I frequently see the following error when I trigger Save All:
  > 
  > ![Image](https://github.com/user-attachments/assets/2b195e6b-6b94-445f-b209-7569e8e7f6b5)
  > 
  > This message appears to be coming from the DA:
  > 
  > ```
  > [2:58:02 PM] [DAP] [Info] ==> {"command":"hotReload","arguments":{"debounce":true,"onlyFlutter":true,"reason":"save"},"type":"request","seq":34}
  > [2:58:02 PM] [DAP] [Info] ==> {"command":"hotReload","arguments":{"debounce":true,"onlyFlutter":true,"reason":"save"},"type":"request","seq":35}
  > [2:58:02 PM] [DAP] [Info] ==> {"command":"hotReload","arguments":{"debounce":true,"onlyFlutter":true,"reason":"save"},"type":"request","seq":36}
  > [2:58:02 PM] [DAP] [Info] ==> {"command":"hotReload","arguments":{"debounce":true,"onlyFlutter":true,"reason":"save"},"type":"request","seq":37}
  > [2:58:02 PM] [DAP] [Info]  {"command":"hotReload","arguments":{"debounce":true,"onlyFlutter":true,"reason":"save"},"type":"request","seq"
  > 
  > _(truncated)_

  * [#5551](https://github.com/Dart-Code/Dart-Code/issues/5551)/[#5555](https://github.com/Dart-Code/Dart-Code/issues/5555): A new opt-in setting `dart.mcpServer` enables automatic registration of the Dart MCP server with VS Code if the current SDK includes it (Dart v3.9.0-163.0.dev or later).

  > **#5551**: [experimental] Add support for advertising the Dart SDK MCP server `is enhancement` `in ai`
  > This uses the new VS Code API `registerMcpServerDefinitionProvider` to allow VS Code to ask us for MCP servers. If we're using a >= Dart 3.9.0-0 SDK and the (currently "hidden") `dart.experimentalMcpServer` setting is enabled, we will return the `dart mcp-server` command.
  > 
  > This allows VS Code to discover our MCP server and tools (which are then available to VS Code and other extensions).
  > 
  > Currently we don't provide a way to pass the DTD URI (at startup, or if we have to restart it, when the MCP server may continue to run - since VS Code controls its lifetime), but this will need adding.
  > 
  > @jakemac53 @kenzieschmoll

