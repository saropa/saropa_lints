# Dart-Code v3-124

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.124.1 _2025-12-02_

  * [#5794](https://github.com/Dart-Code/Dart-Code/issues/5794)/[#5828](https://github.com/Dart-Code/Dart-Code/issues/5828): The connection to the Dart Tooling Daemon now has a WebSocket ping enabled, preventing dropped connections if proxies (such as Norton 360 antivirus) drop connections after some period with no traffic.

  > **#5794**: Dart Tooling Daemon connection terminates after 60s idle with Norton antivirus installed `is bug` `in dtd`
  > **Describe the bug**
  > When you build any app using Flutter, in my case I created a new app using the empty app template that comes with Flutter/VS Code.  So to clarify if you create a new app using VS Code (View/Command Pallete/Empty Application) then select Run the app will build successfully and run on my real Android phone. It could be a few minutes latter that the app exits and displays this error. This happens on two different Android phones and two different USB cables. I'm also getting the error 'Unhandled exception:
  > FileSystemException: writeFrom failed, path = '' (OS Error: The pipe is being closed. , errno = 232)' which may be caused by the daemon exiting?
  > 
  > _(truncated)_

  * [#5827](https://github.com/Dart-Code/Dart-Code/issues/5827): The `macos/Flutter/ephemeral` folder (with a capital `F`) is now also hidden like the Windows/Linux versions of the folder (with lowercase `f`).

  > **#5827**: `macos/Flutter/ephemeral` isn't excluded in `files.exclude` `is bug` `in editor`
  > **Describe the bug**
  > 
  > https://github.com/Dart-Code/Dart-Code/issues/5776 hid `linux/flutter/ephemeral` and `windows/flutter/ephemeral` with this regex:
  > 
  > > ```
  > > 	"**/flutter/ephemeral": true,
  > > ```
  > 
  > But since `macos/Flutter/ephemeral` has a capital F, it's not excluded as expected.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Open a Flutter project in VSCode. You may need to be on a case-sensitive file system (the Linux default).
  > 2. See that `linux/flutter/ephemeral` and `windows/flutter/ephemeral` correctly do not appear in the explorer.
  > 3. See that `macos/Flutter/ephemeral` is still there, with files like `Flutter-Generated.xcconfig`.
  > 
  > **Expected behavior**
  > The macos ephemeral folder should be excluded just like the linux/windows ephemeral folders.
  > 
  > **Screenshots**
  > 
  > **Please complete the following information:**
  > 
  > _(truncated)_




# v3.124.0 _2025-12-01_

## Flutter Widget Preview

  * [#2620](https://github.com/Dart-Code/Dart-Code/issues/2620): The Flutter Widget Preview is enabled by default when using the recently-released Flutter v3.38.

  > **#2620**: Add support for embedded Flutter widget preview `is enhancement` `in flutter` `in flutter widget preview`
  > Hi everyone,
  > 
  > I was reading about Android jetpack compose and iOS swift UI, and thinking that flutter is falling a little behind on it's lead of developer experience.
  > 
  > IMHO We need to quickly supply developers a live preview of the widget they are working on.
  > It shouldn't be that hard if dartpad and codepen do it, since vscode is basically a web browser itself.
  > 
  > I feel it would greatly improve developer experience, since you wouldn't need to either:
  > 1. spawn an emulator, with all the additional RAM and CPU it consumes wait for it to come online, and then wait for that long initial build;
  > 2. connect an external device and wait for that long initial build, and have the device suck the battery out of your laptop, or have to do it all over again;
  > all this just to check if the widget you're working on looks like what you expected.
  > 
  > Thanks,
  > Best Regards,
  > d-silveira

  * [#5775](https://github.com/Dart-Code/Dart-Code/issues/5775): The Flutter Widget Preview now works for _all_ projects within a Pub Workspace instead of only the first.

  > **#5775**: Support multiple Flutter projects in the same Pub workspace for Widget Preview `is enhancement` `in flutter widget preview`
  > See https://github.com/Dart-Code/Dart-Code/issues/5671#issuecomment-3466839581
  > 
  > Widget Preview does support a Pub workspace, but probably needs invoking at the root of the workspace and not within a single project.
  > 
  > We should support this like the CLI does, even though we don't support multiple unrelated projects.
  > 
  > @bkonyi the only concern I have here, is what if I open a subset of a Pub Workspace. For example if I open just `pkg/analysis_server` in the SDK (assuming it was Flutter) - would widget preview scan the entire SDK (Pub Workspace) for widget previews?
  > 
  > I wonder if we could restrict this to just the _open_ folders (which perhaps could be done together with https://github.com/flutter/flutter/issues/173550?)
  > 
  > (cc @GabrielRStabile)

  * [#5783](https://github.com/Dart-Code/Dart-Code/issues/5783): The Widget Preview now shows the correct background color when embedded in the sidebar.

  > **#5783**: Wrong background color for widget preview in sidebar `is bug` `in flutter` `in flutter widget preview`
  > We're using the editor BG colour here in the sidebar.




## Flutter

  * [#5796](https://github.com/Dart-Code/Dart-Code/issues/5796): If the Flutter daemon times out unexpectedly on macOS, a notification will now be shown.

  > **#5796**: Show a notification for Daemon timeouts on macOS for pre-release users `is enhancement` `in flutter` `on mac`
  > This is to help gather more information about the issue in https://github.com/Dart-Code/Dart-Code/issues/5793, that the timeout added for trying to track down a Windows-only issue seems to be record a lot of timeouts on macOS.

  * [#5782](https://github.com/Dart-Code/Dart-Code/issues/5782): Switching SDKs no longer reports “View provider for ‘sidebarWidgetPreview’ already registered”.

  > **#5782**: "View provider for 'sidebarWidgetPreview' already registered" when switching SDK `is bug` `in flutter` `in flutter widget preview`
  > See https://github.com/flutter/flutter/issues/178052#issuecomment-3496305716




## Editor

  * [#5599](https://github.com/Dart-Code/Dart-Code/issues/5599): Go-to-Definition now works on keywords like `return`, `break`, and `continue`, jumping to the corresponding token.

  > **#5599**: Support Go-to-Definition / ctrl+click on keywords like `return`, `break`, `continue` `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > Release notes placeholder for work done as part of https://github.com/dart-lang/sdk/issues/50532 / https://dart-review.googlesource.com/c/sdk/+/441520

  * [#4844](https://github.com/Dart-Code/Dart-Code/issues/4844): All exit points of a function/block such as `return`, `break`, and`continue` are highlighted together when the text cursor is in one of them.

  > **#4844**: Show all function exit points by clicking on `return` or the return type `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Is your feature request related to a problem? Please describe.**
  > 
  > Eclipse has a nice feature where clicking on either a `return` statement or the return type of a function, all the exit points of the function are highlighted (whether they are `return` statements, `throw` statements, etc.).
  > 
  > Dart doesn't have checked exceptions, so doing this in Dart won't give the user a complete view of all the ways a function can exit (well, to be fair, Java also has unchecked exceptions, so it's not complete for Java either) -- but even being able to easily spot most of the return points in Dart would be really helpful.

  * [#5810](https://github.com/Dart-Code/Dart-Code/issues/5810): The color picker/previews now appear when using the new dot shorthand syntax.

  > **#5810**: color picker not shows with dot shorthand syntax `is bug` `in flutter` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > Doesn't shows color picker if we use dot shorthand syntax. like this: `color: .new(0xffffffff)` , `color: .fromARGB(255, 255, 255, 255)`

  * [#5772](https://github.com/Dart-Code/Dart-Code/issues/5772): Raw strings (starting `r'` or `r"`) are now automatically closed just like normal strings.

  > **#5772**: Auto-close raw strings `is enhancement` `in editor`
  > **Is your feature request related to a problem? Please describe.**
  > You usually have "closing" completion for brackets and quotes, but not for raw strings.
  > 
  > **Describe the solution you'd like**
  > I'd like for the IDE to automatically close `r'` or `r"` with the corresponding quote.
  > 
  > **Describe alternatives you've considered**
  > Manually adding the quote.
  > 
  > **Additional context**
  > It works on Python, so this might be doable (try `a = f""` or `a = f''` - formatted string - on a `.py` file).

  * [#5754](https://github.com/Dart-Code/Dart-Code/issues/5754): The “Add ‘foo’ to dependencies” quick-fix is now available even if the package name is a prefix of another existing dependency.

  > **#5754**: Add `package` to dependencies doesn't trigger when the dependency is the prefix for another existing dependency `is bug` `in editor`
  > **Describe the bug**
  > Currently, the extension shows a fix for `depend_on_referenced_package`, but I found a case that doesn't show the fix.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Add `analyzer_plugin: 0.13.9` to the dependencies and create a subclass of `ServerPlugin`, which should ask to add missing members and one of them will use the `analyzer` class `AnalysisContext`
  > 2. The import it shows is from a non-direct dependency and will cause the diagnostic to trigger
  > 3. I believe the extension only tracks if we have a dependency where the name starts with `analyzer` so this case doesn't show up
  > 
  > **Expected behavior**
  > For the fix to show up.
  > 
  > **Screenshots**
  > 
  > **Please complete the following information:**
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.121.20250930
  > Flutter extension: 3.121.20250930 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: win 1.105.1
  > 
  > Workspace type: Dart (LSP)
  > Workspace name: essential_lints
  > 
  > _(truncated)_

  * [#5776](https://github.com/Dart-Code/Dart-Code/issues/5776): The `flutter/ephemeral`, `.symlinks` and `.plugin_symlinks` folders are now excluded from the explorer and search results by default. The `.dart_tool` folder is also now excluded from search results by default. If you’d prefer these were included, you can add them back by adding them to `files.exclude` and `search.exclude` configuration with a value of `false`.

  > **#5776**: Hide files under `ephemeral` from text search `is enhancement` `in editor`
  > **Is your feature request related to a problem? Please describe.**
  > I've used text search for `'dart:developer'` in a Flutter project with some dependencies (say `connectivity_plus`). And under the `linux` folder, it creates a `main.dart` file (`my_package_folder\linux\flutter\ephemeral\.plugin_symlinks\connectivity_plus\example\lib\main.dart`).
  > 
  > **Describe the solution you'd like**
  > Ideally, we can remove these `ephemeral` paths from the default text search.
  > 
  > **Describe alternatives you've considered**
  > Manually adding `,**/ephemeral/**` to whatever text search you do under the `files to exclude` section.
  > 
  > I also can't think of any good reason to ever look under `.plugin_symlinks` specifically. Maybe we could hide those from the file explorer (which might solve this).

  * [#5755](https://github.com/Dart-Code/Dart-Code/issues/5755): A one-off warning is now shown if the `dart.onlyAnalyzeProjectsWithOpenFiles` setting is enabled. Use of this setting is not recommended as it can cause bad performance when moving around the codebase.

  > **#5755**: Show a one-off warning about onlyAnalyzeProjectsWithOpenFiles `is enhancement` `in editor` `is performance`
  > See https://github.com/dart-lang/sdk/issues/61742




## AI

  * [#5785](https://github.com/Dart-Code/Dart-Code/issues/5785)/[#5795](https://github.com/Dart-Code/Dart-Code/issues/5795): When using Copilot, the Format tool and the Fix All tool from the Dart MCP server (which read and modify files on disk) are now replaced with extension-provided versions that work nicely with unsaved edits.

  > **#5785**: Dart MCP server commands that modify files on disk can conflict with unsaved files `is bug` `in ai`
  > Some of the MCP server commands modify files on disk directly, so if there are unsaved changes you can result in conflicts when trying to save:
  > 
  > We previously excluded the `run_tests` tool in the MCP server (https://github.com/Dart-Code/Dart-Code/pull/5639) because VS Code contributes a version that works better inside the editor. I wonder if we should do something similar here:
  > 
  > - Identify any commands that might modify directly on disk
  > - Ensure Dart-Code (or VS Code) exposes the equivalent command directly
  > - Hide the MCP version of the tool
  > 
  > We should try to avoid duplicating functionality that we don't already have and is in the MCP server, but for things like format where we already have implementations but they're just not exposed to the model, maybe it makes sense to just expose them?
  > 
  > We'd need to review the full set and agree which this makes sense for.
  > 
  > WDYT @jakemac53?

  * [#5647](https://github.com/Dart-Code/Dart-Code/issues/5647): When using Copilot, the `analyze_files` tool from the Dart MCP server is now disabled in favour of the VS Code `problems` tool which provides live analysis errors from the open files and does not trigger re-analyzing files on disk.

  > **#5647**: Exclude analyze_files from MCP Server when VS Code's built-in `problems` tool supports whole workspace `is enhancement` `in ai`
  > When https://github.com/microsoft/vscode-copilot-chat/pull/394 ships, we should test excluding the analyze_files tool and check that models will instead use #problems because it will handle unsaved files and be faster (since it doesn't require new analysis).




## DevTools

  * [#3488](https://github.com/Dart-Code/Dart-Code/issues/3488): When using Flutter v3.38 / Dart 3.10, using Cmd+C on macOS to copy from embedded DevTools pages should now work as expected.

  > **#3488**: Can't copy text from DevTools with Cmd+C `is bug` `in devtools`
  > **Describe the bug**
  > It's not possible to copy text from from VS Code integrated Dart DevTools to pasteboard on macOS. It's possible to highlight the text, but copy doesn't work. Copy works fine when you open DevTools in browser.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Start debug session
  > 2. Open Dart DevTools - Network Page
  > 3. Make a request
  > 4. Click on Request -> Response
  > 5. Select text and copy it (CMD + C)
  > 
  > **Expected behavior**
  > Text to be copied to pasteboard.
  > 
  > **Versions (please complete the following information):**
  >  - VS Code version: 1.58.2 (Universal)
  >  - Dart extension version: 3.24.2
  >  - Dart/Flutter SDK version: 2.2.3




## Testing

  * [#5799](https://github.com/Dart-Code/Dart-Code/issues/5799)/[#5575](https://github.com/Dart-Code/Dart-Code/issues/5575): Code coverage is now enabled for Dart projects if using the latest version of `pkg:test`, however it currently only captures coverage for the current package. [#5798](https://github.com/Dart-Code/Dart-Code/issues/5798) is open to track adding support for all workspace packages (this is already supported for Flutter).

  > **#5799**: Add support for Coverage in Dart projects `is enhancement` `in dart` `in testing`
  > Currently this only supports coverage for the project hosting the tests, we need `--coverage-package` to be implemented in Dart to support capturing it for other projects in the workspace like we do for Flutter.
  > 
  > Fixes https://github.com/Dart-Code/Dart-Code/issues/5575

  * [#5797](https://github.com/Dart-Code/Dart-Code/issues/5797): Code coverage reports that contain absolute Windows paths now parse correctly.

  > **#5797**: Coverage doesn't parse correctly if the lcov file contains an absolute file path on Windows `is bug` `in flutter` `in dart` `in testing`
  > While testing enabling coverage for Dart, I noticed that the lcov files can sometimes have absolute file paths:
  > 
  > ```
  > SF:D:\Dev\Test Projects\coverage_testing\dart_package_1\lib\dart_package_1.dart
  > ```
  > 
  > And because we split on `:` and then check for 2 fields, this fails. We need to only split on the first `:`.

  * [#5707](https://github.com/Dart-Code/Dart-Code/issues/5707)/[#5811](https://github.com/Dart-Code/Dart-Code/issues/5811): Running tests defined in a non-`main` function no longer report “No tests match regular expression …”.

  > **#5707**: "No tests match regular expression ..." when running tests in reusable test suite functions `is bug` `in testing`
  > **Describe the bug**
  > When running a group or a test (via clicking 'run' or 'debug' on the group / test) in VSCode, and those groups / tests are defined in a reusable test suite function, the test is not run and this error message is presented:
  > 
  > For group:
  > ```
  > No tests match regular expression "^With id value 42".
  > ```
  > For test:
  > ```
  > No tests match regular expression "^With id value 42 when someOperation is called then 2 is returned( \(variant: .*\))?$".
  > ```
  > 
  > The technical problem is that the regex prefix `^` is being added. I'm not aware of the reason for it to exist in the first place, but given that writing reusable test suite functions should at least be somewhat common, at the very least it should be possible to disable - either in settings or via some mechanism in the test source file.
  > 
  > For context, the use case we have is contract tests: The same tests are run against real world API clients as well as against our mocks of them. See the repro example below.
  > 
  > **See also:**
  > 
  > _(truncated)_




## Commands

  * [#5801](https://github.com/Dart-Code/Dart-Code/issues/5801)/[#5789](https://github.com/Dart-Code/Dart-Code/issues/5789): Commands like **Get Packages** now show the package name in the output instead of just the folder name (which is usually - but not always - the same).

  > **#5801**: Use "package:foo" instead of foldernames in command execution `is enhancement` `in commands`
  > Fixes https://github.com/Dart-Code/Dart-Code/issues/5789

  * [#5777](https://github.com/Dart-Code/Dart-Code/issues/5777): When running **Pub Get** on a batch of packages, the notification now shows a progress indicator and the number of done/total packages.

  > **#5777**: Show progress in batch operation notification `is enhancement` `in commands`
  > https://github.com/Dart-Code/Dart-Code/pull/5746 is neat, ty!
  > 
  > Could the notification be improved by either:
  > - adding a progress bar in there (don't think this is possible)
  > - adding a prefix or suffix `current/total` (e.g. `1/30`) counter in the notification?

  * [#5803](https://github.com/Dart-Code/Dart-Code/issues/5803): The **Dart: Open Analyzer Diagnostics / Insights** command now show a progress indicator if it does not respond immediately (for example while the server is busy starting up).

  > **#5803**: Custom requests to the server like `Open Diagnostics Page` should have an indication after a short period `is enhancement` `in commands`
  > **Is your feature request related to a problem? Please describe.**
  > I've noted that we need to wait for the initial analysis to happen for custom requests like `Open Diagnostics Page` to respond. Also, if the server is doing some heavy computation (reanalysing many libraries without fine-grained, for example), it also gets stuck.
  > 
  > **Describe the solution you'd like**
  > I'd like Dart-Code to display a progress indication about these requests so that I don't request them more than once, thinking they didn't get through.




## Extension API

  * [#5770](https://github.com/Dart-Code/Dart-Code/issues/5770)/[#5703](https://github.com/Dart-Code/Dart-Code/issues/5703): Other VS Code extensions can now suppress debug CodeLenses via the exposed API. This allows projects like Jaspr to replace these with their own CodeLenses that invoke their own debugger.

  > **#5770**: Add the ability to suppress CodeLens via the API `is enhancement` `in api`
  > Fixes https://github.com/Dart-Code/Dart-Code/issues/5703

  * [#5587](https://github.com/Dart-Code/Dart-Code/issues/5587): Internal extension APIs intended for use only in automated test runs are no longer exposed outside of test runs.

  > **#5587**: Remove internal APIs from `exports` when not in a test run `in api`
  > We currently export a bunch of internal classes from the extensions `activate` method in a `_privateApi` field to make testing easier. These were never intended for use outside of tests, but some other extensions have started using them to get access to things they can't easily get elsewhere (for example the SDK paths or Outline data).
  > 
  > Because these classes were never meant as public API, they often change in breaking ways so we should remove them and only expose them when running in a test run. But first we should try to provide alternatives for extensions where it's reasonable. This issue tracks the known extensions using these APIs, what they use, and whether they have migrated off them.
  > 
  > The initial API provides access to the DTD URI and the current SDK paths (https://github.com/Dart-Code/Dart-Code/pull/5583). This will ship with `version == 2` in v3.116 at the start of August.
  > 
  > _(truncated)_




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

  * [#5773](https://github.com/Dart-Code/Dart-Code/issues/5773): The **Dart: Apply Fix All in Workspace** command now shows a progress indicator while it computes.

  > **#5773**: `Dart: Apply Fix All in Workspace` running toast `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Is your feature request related to a problem? Please describe.**
  > I ran `Dart: Apply Fix All in Workspace` with a list of 4887 diagnostic to fix, and although it ran fine, I could not tell that it was running.
  > 
  > **Describe the solution you'd like**
  > I'd like to see a toast to indicate that some processing is happening.
  > 
  > **Describe alternatives you've considered**
  > Doing it from the terminal allows me to see that the process is running since I can't write more things.

  * [#5818](https://github.com/Dart-Code/Dart-Code/issues/5818): Breadcrumbs and other UI now show `extension on Foo` instead of just `<unnamed extension>` for unnamed extensions.

  > **#5818**: Improve the display of "<unnamed extension>" in breadcrumbs etc. `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > For an extension, we could show something like `""` or something instead? Or just "extension on FooClass" (which looks like the declaration)?

  * [#5781](https://github.com/Dart-Code/Dart-Code/issues/5781): Quick-fixes provided by the Dart analysis server for `pubspec.yaml` and `analysis_options.yaml` are now available to VS Code.

  > **#5781**: No quick-fixes in pubspec.yaml or analysis_options.yaml `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > There should be a fix here, we have a test for it in server.

  * [#5779](https://github.com/Dart-Code/Dart-Code/issues/5779): The `dart.inlayHints` configuration now has an additional setting to control inlay hints for dot shorthands.

  > **#5779**: Add dot-shorthand config to dart.inlayHints `is enhancement` `in editor` `relies on sdk changes`
  > https://github.com/dart-lang/sdk/issues/61841 adds a new kind of inlay hints, so we need to update the config setting so the toggle for this shows up in the `settings.json` code completion.

  * [#5778](https://github.com/Dart-Code/Dart-Code/issues/5778): Copying large variable values from the Globals list when debugging now copies the whole untruncated value.

  > **#5778**: Cannot copy variable value when it's bigger than a certain length `is bug` `in debugging` `relies on sdk changes`
  > **Describe the bug**
  > When debugging, if I have a local variable of String type in the Variables window and its value is bigger than a certain length, the debugger will show it truncated with ellipsis and hitting Ctrl + C or right-clicking > Copy Value will only copy the shown value (truncated).
  > 
  > There's currently no alternative that I know of:
  > 
  > Using the debug console won't work for accessing private fields of other classes (and maybe would show the value truncated anway? Not sure)
  > Hovering over the variable in the editor also shows the value truncated;
  > There's no configuration option in launch.json for type:dart that I know of that controls this (apparently some other languages has an option for configuring this).
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Create a String local with a big length (eg > 1500 characters)
  > 2. Start debugging (type: dart, request: launch)
  > 3. Use the Variables window to inspect your variable
  > 
  > **Expected behavior**
  > I can copy the full value
  > 
  > _(truncated)_

