# Dart-Code v3-90

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.90.0 _2024-05-29_

## Fix All in Workspace Commands

[#5022](https://github.com/Dart-Code/Dart-Code/issues/5022): When using Flutter 3.22 / Dart 3.4, new commands **Dart: Apply Fix All in Workspace** and **Dart: Preview Fix All in Workspace** are available.

  > **#5022**: Add "Fix All in Workspace" commands to apply fixes across the whole workspace instead of only current file `is enhancement` `in editor`
  > Seems we don't have an issue tracking this. We should support running "dart fix" for your workspace in the IDE, rather than telling users to run from the command line.


![](/images/release_notes/v3.90/fix_all_commands.png)

The **Apply** version of the command will fix all auto-fixable issues across the whole workspace, similar to running `dart fix`. The **Preview** version of the command will open VS Codeâ€™s refactor preview allowing you to choose which fixes to apply. You can use the context menu to group these changes by the issue that they are fixing (add ğŸ‘ to [this VS Code issue](https://github.com/microsoft/vscode/issues/207580) if youâ€™d like to see this enabled by default and [to this VS Code issue](https://github.com/microsoft/vscode/issues/207578) for having the changes ticked by default).

![](/images/release_notes/v3.90/fix_all_preview.png)

## Automatically Close DevTools on Debug End

[#5029](https://github.com/Dart-Code/Dart-Code/issues/5029): A new setting **Dart: Close DevTools** (`dart.closeDevTools`) has been added to allow automatic closing of embedded DevTools windows like the Widget Inspector when a debug session ends. The `ifOpened` option will close only embedded windows that were opened automatically as a result of the **Dart: Open DevTools** (`dart.openDevTools`) setting.

  > **#5029**: Close Embedded Widget Inspector Window on Debug Session End `is enhancement` `in debugging` `in devtools`
  > I find it slightly annoying that I have to manually exit out of the embedded widget window when I'm done with a debug session to get back to the view I was in prior to starting the debug session.  I would like to propose a new settings flag that controls whether the debug window closes automatically upon debug session end or not.
  > 
  > I think a solution to this problem would be to add a Dart->DevTools settings flag similar to 'Dart: Dev Tools Reuse Windows' which would then control whether or not this happens on debug session end. Then, in handleDebugSessionEnd() or a more appropriate location, add code to call DevToolsEmbeddedView.dispose() (currently set to private) for the embedded view associated with the session.  
  > 
  > Included is a screenshot with some pseudocode I wrote as a proposed solution.  Thanks for your consideration.
  > 
  > ![proposedChange](https://github.com/Dart-Code/Dart-Code/assets/36205786/d333012e-9030-410f-93e2-4b8224f5a2ac)


![](/images/release_notes/v3.90/close_dev_tools.png)

## DevTools

  * [#5116](https://github.com/Dart-Code/Dart-Code/issues/5116): Dragging an embedded DevTools window out into its own VS Code Window no longer results in a blank page but instead reloads the tool (at this time, any state within the tool may be reset).

  > **#5116**: Widget Inspector breaks when its tab is undocked or re-docked. `is bug` `in devtools`
  > ## Description
  > 
  > When I open the Widget Inspector, and then grab the tab and drag it outside of the main window to turn it into a separate floating window, the window goes blank and the inspector no longer works until I reload the entire app.  Even then, I have to restart my debug session and turn on the Widget Inspector again before it will show up in the floating window.
  > 
  > The same thing happens if I drag the external tab back into the main window to dock it.
  > 
  > Seems like the Widget Inspector has trouble re-homing itself.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Open VSCode on a Flutter app (sample app will do)
  > 2. Debug the app (I was on Linux debugging a native linux app)
  > 3. Click the widget inspector button to show it in a tab next to the editor window.
  > 4. Drag the tab outside of the main window to undock the tab.
  > 5. Notice that it's blank.
  > 6. Do Ctrl-Shift-P and execute the "Developer: Reload Window" action.
  > 7. Debug the app again
  > 8. Open the widget insp
  > 
  > _(truncated)_

  * [#5046](https://github.com/Dart-Code/Dart-Code/issues/5046): Actions that trigger a restart of the DevTools server will now cause embedded DevTools windows to be reloaded so that they can be reconnected to the new server/Dart Tooling Daemon.

  > **#5046**: Stale DTD uri in open Devtools screens after analysys server restart `is bug` `in devtools`
  > ## Reproduction
  > 1. Run a flutter app in vscode 
  > 2. In Vscope run the "Copy DTD Uri to Clipboard" command
  > 3. open a devtools pane or devtools in a window
  > 4. Check your uri:
  >     -If you are in a Devtools pane,  then "Toggle Developer Tools" you should be able to search for the copied "DTD Uri" and see that it matches
  >     - If you are in the browser, open the developer console. You should be able to search for the copied "DTD Uri" and see that it matches
  >  5. Restart the analysis server
  >  6. In Vscope run the "Copy DTD Uri to Clipboard" command
  >  7 If you go back to the open devtools pane or window, you should see that the new dtd uri no longer matches the dtd uri in the console.
  >  
  >  ## Proposed approach
  >  Is it possible for us to trigger a refresh of any devtools windows/panes after we do an analysis/dtd restart?
  >  - One issue we may run into is any windows that have been opened up to devtools, may be left stale unless we have a way to ask them to refresh (possible from the devtoo
  > 
  > _(truncated)_




## Misc

  * [#5084](https://github.com/Dart-Code/Dart-Code/issues/5084): The Dart language server will now be terminated more reliable/quickly when closing VS Code during initial analysis of very large workspaces.

  > **#5084**: Code Helper is orphaning Dart processes that dominate cpu `is bug`
  > ## Describe the bug
  > I noticed that I had 8 stray dart processes on my computer that were occupying 100% of the CPU.  I killed them then noticed the next day that I had a dart process dominating one of my cores again.  I noticed the parent process was "Code Helper" so I closed all my apps, including vscode and the process did not disappear but was now being reported as having no parent.
  > 
  > ## screenshots
  > 
  > ### while vscode is open
  > 
  > 
  > 
  > 
  > ### after vscode is closed
  > 
  > 
  > 
  > ## info
  > 
  >  - Operating System and version: MacOS 14.4.1
  >  - VS Code version: 1.88.1
  >  - Dart extension version: ?
  >  - Dart/Flutter SDK version: `Flutter version 3.22.0-15.0.pre.` `Dart version 3.5.0 (build 3.5.0-84.0.dev)`
  >  - Target device (if the issue relates to Flutter debugging): na




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

  * [#5113](https://github.com/Dart-Code/Dart-Code/issues/5113): Analysis errors will no longer sometimes reappear for deleted/moved files if an analyzer plugins generate new diagnostics after the delete/move.

  > **#5113**: Server diagnostics can reappear for deleted/moved files if analyzer plugins generate new diagnostics (even if empty) `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > Moved, renamed or deleted file analysis warnings and lints don't dissapear
  > From https://github.com/Dart-Code/Dart-Code/issues/4658
  > dart_code_metrics - third party
  > 
  > **To Reproduce**
  > 
  > pubspec.yaml
  > 
  > ```
  > name: 'test'
  > description: test
  > publish_to: 'none'
  > 
  > version: 0.1.0+1
  > 
  > environment:
  >   sdk: '>=3.0.5=3.13.0'
  > 
  > dependencies:
  >   flutter:
  >     sdk: flutter
  > 
  > dev_dependencies:
  >   dart_code_metrics: ^5.7.6
  >   flutter_test:
  >     sdk: flutter
  >   flutter_lints: ^4.0.0
  > ```
  > 
  > 
  > 
  > analysis_options.yaml
  > 
  > ```
  > analyzer:
  >   plugins:
  >     - dart_code_metrics
  > include:
  >     package:lints/recommended.yaml
  > ```
  > 
  > 
  > 
  > copy paste main.dart  -> (need wait some time. check video) 
  > 
  > 
  > **Video**
  > ![Code_cBnW1Pym8g](https://github.com/Dart-Code/Dart-Code/assets/58988648/063e1b31-1fe0-4027-a9fa-a0c2a63291a1)
  > 
  > 
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.88.1
  > Flutter extension: 3.88.0 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version:
  > 
  > _(truncated)_

  * [#5072](https://github.com/Dart-Code/Dart-Code/issues/5072): Output to `stdout` (such as from `print`) during debug sessions will now be scanned for paths/package URIs that can be made clickable links in Dart projects when using the SDK debug adapters.

  > **#5072**: Debug Console doesn't add clickable links for stdout output when using new Dart SDK debug adapters  `is bug` `in debugging` `in dart` `relies on sdk changes`
  > Splitting from https://github.com/Dart-Code/Dart-Code/issues/4711 since there are two sets of work here - one to support in the base adapters, and one to update the Flutter adapter.
  > 
  > Here's an example of the issue in Dart:
  > 
  > ```dart
  > import 'dart:io';
  > 
  > void main() {
  >   print('stdout');
  >   stdout.write(StackTrace.current);
  >   print('stderr');
  >   stderr.write(StackTrace.current);
  > }
  > ```
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/1078012/12acd82a-8bad-4b34-8522-37936f71a248)
  > 
  > 
  > In the old debug adapters it looks like:
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/1078012/dfa0adfd-594e-49de-9b6b-f8110a768212)

  * [#4711](https://github.com/Dart-Code/Dart-Code/issues/4711): Output to `stdout` (such as from `print`) during debug sessions will now be scanned for paths/package URIs that can be made clickable links in Flutter projects when using the SDK debug adapters.

  > **#4711**: Debug Console doesn't add clickable links for stdout output when using new Flutter SDK debug adapters `is bug` `in flutter` `in debugging` `relies on sdk changes`
  > **Describe the bug**
  > Until about a week ago in the PREVIEW release, clickable code links were showing up on the right side of the "Debug Output" window if the format was using this format:
  > `  (:::)`
  > It was convenient. 
  > 
  > Now the code appears unformatted and unclickable.   I checked to see if there might have been a setting that got turned off but couldn't find anything to enable that feature.
  > 
  > Note the release version of the plugin still works as described
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Print to the console with say: `print('New route pushed: ServicesRoute (package:app/router.dart:61:9)'`
  > 
  > **Expected behavior**
  > The above line should produce a clickable link on the right side
  > 
  > **Screenshots**
  > Release version
  > ![Release version of extension](https://github.com/Dart-Code/Dart-Code/assets/5289174/93770325-f095-404d-b6dc-aa836b2581e4)
  > 
  > Current Pre Release
  > ![Pre Release of extension](https://github.com/Dart-Code/Dart-Code/assets/5289174/4dace64f-a1a5
  > 
  > _(truncated)_

