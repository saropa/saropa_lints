# Dart-Code v3-50

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.50.0 _2022-10-03_

## Flutter

  * [#3808](https://github.com/Dart-Code/Dart-Code/issues/3808): Attaching to a Flutter process started outside of VS Code no longer requires manual configuration of the `packages` file in order for the debugger to correctly locate files while debugging/stepping. This fix applies only to the new SDK DAPs (which can be opted-in to using the `dart.previewSdkDaps` setting).

  > **#3808**: Attaching to running flutter process doesn't highlight source paused on `is bug` `in flutter` `in debugging`
  > **Describe the bug**
  > When starting a flutter project using `flutter run` outside of vscode and then attaching the debugger inside vscode by running `>Debug: Attach to Flutter on Device` and pasting the URI provided by flutter, it is possible to set a breakpoint in a file and the debugger also stops the app, but it doesn't give any information about the current state and doesn't highlight the line that's paused on. The problem only occurs if in vscode the flutter project is nested in subfolder. As setting the breakpoint and breaking on it works correctly, but from then on it's pretty useless, it's hard to figure out what's wrong.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Create a flutter project in a subfolder of the current vscode workspace (`mkdir -p flutter-test/src; code flutter-test; cd flutter-test/src; flutter create .`)
  > 2. Start the flutter app using the CLI on a connected (android) device (`flutter run`)
  > 3. Attach to the running flutter app on the connected d
  > 
  > _(truncated)_




## Editor

  * [#4152](https://github.com/Dart-Code/Dart-Code/issues/4152): The â€œRunâ€/â€Debugâ€ CodeLens links now appear on the line directly above the `main` method name, and not above the related DartDoc comments.

  > **#4152**: Move the location of the run/debug links to just above the function. `is enhancement` `in editor` `in debugging` `in commands`
  > Dart-Code: v3.48.3
  > 
  > When debugging unit tests (or any main) dart-code places a two links above the function Run | Debug.
  > 
  > The links launch the app.
  > 
  > I often use these when working on unit tests.
  > 
  > My (minor) problem is that the Run | Debug links are placed above the comments associated with the method:
  > 
  > ![image](https://user-images.githubusercontent.com/900408/189270291-d7b2f609-a28a-4e92-8e60-9656d70b2919.png)
  > 
  > 
  > As you can see from the image I often have rather long comments sections.
  > 
  > When iterating over a unit test to isolate a problem I'm having to constantly scroll from the code in the unit test (that I'm editing) back up to the Run | Debug links.
  > 
  > It would be much more convenient if these links where just above the function (main) rather than above the comments.




## Other

  * [#4178](https://github.com/Dart-Code/Dart-Code/issues/4178): In a multi-folder workspace, running a debug session without an explicit `cwd` or one that can be inferred from `program` will now use the nearest common ancestor of all open workspace folders (if one can be found that is not the drive root).

  > **#4178**: Infer a default CWD for workspaces with multiple folders if they have a common ancestor `is enhancement`
  > @helin24 can you verify this works for your case?

  * [#4134](https://github.com/Dart-Code/Dart-Code/issues/4134): When using the **Dart: Capture Logs** commands, long lines are no longer truncated. Logs written to disk using the related settings are still truncated based on the `dart.maxLogLineLength` setting.



## Rollout of New SDK Debug Adapters

[#4194](https://github.com/Dart-Code/Dart-Code/issues/4194): Several issues that led to pausing the rollout of the [new SDK debug adapters](/releases/#new-debug-adapters-for-dart-and-flutter) have been resolved in latest bleeding-edge builds of Dart/Flutter. As such, rollout will continue when using an SDK version with these fixes (which is currently only users of the Flutter/Dart master branches).

  > **#4194**: Re-enable SDK DAPs `in debugging`
  > Progressive rollout will be re-enabled for stable releases that include fixes for known issues. For pre-release SDK users, everyone will be opted-in that has those fixes.


Additionally, users of pre-release SDKs (with a sufficient version number to include the fixes noted above) will immediately be opted-in to the new DAPs (skipping the progressive rollout used on the stable branch). If you notice any unexpected behaviour while debugging (or while not debugging ðŸ™‚) please [file issues](https://github.com/Dart-Code/Dart-Code/issues/new/choose) which as much detail as possible!

## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They will show up automatically when you update your SDK in future (or sooner if using beta/development channels - depending on the exact version).

  * [#612](https://github.com/Dart-Code/Dart-Code/issues/612): Call Hierarchy is now available (`Shift` \+ `Alt/Option` \+ `H`, or from the context menu).

  > **#612**: Add call hierarchy feature `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > Don't know if it's possible. It's possible to check a function's call hierarchy in IntelliJ. Is it possible to bring it to VSCode?

  * [#4154](https://github.com/Dart-Code/Dart-Code/issues/4154)/[#3609](https://github.com/Dart-Code/Dart-Code/issues/3609)/[#4160](https://github.com/Dart-Code/Dart-Code/issues/4160): Inlay hints are now available for inferred types and parameter names (shown while holding `Ctrl` \+ `Alt/Option`).

  > **#4154**: Show inferred types as inline code `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > I've been writing some Rust code and I've appreciated the inline declarations of inferred types.  It makes reading and working with code much easier.  This is apropos Dart where some repositories enforce the explicit declaration of types whereas others don't.
  > 
  > Here is an example of the Rust extension showing inferred types (and parameter names but this issue isn't asking for that):
  > 
  > 
  > `: &Option>>` is the inferred type of `result`.  It doesn't exist in the file but it would be valid code had it been written there.  The inline hint is itself valid code, which is important.
  > 
  > So in Dart's case it would look like this:
  > ```dart
  > final x = add(1, 2);
  > ```
  > becomes:
  > ```dart
  > final int x = add(1, 2);
  > ```
  > Where `int` doesn't exist in the code but is displayed as above as if it was.

  * [#4143](https://github.com/Dart-Code/Dart-Code/issues/4143): Auto-imports now work when completing extension members.

  > **#4143**: Auto-imports not working for extension members `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > Using a recent nightly (which uses `NotImportedContributor`), completing on `firstOrNull` from `package:collection` does not add the `import` statement:
  > 
  > 
  > 
  > Importing on something else (like `calculate()` from the default command line project) does insert the import statement.

  * [#4131](https://github.com/Dart-Code/Dart-Code/issues/4131): Renaming a symbol no longer updates DartDocs with unresolved identifiers of the same name.

  > **#4131**: Renaming a symbol renames unrelated doc references all over the place. `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > ## Description
  > 
  > If I have code like this in `file1.dart`:
  > 
  > ```dart
  > class MyClass {
  >   int field;
  > }
  > ```
  > 
  > And code like this in `file2.dart`:
  > 
  > ```dart
  > class MyOtherClass {
  >   static int field;
  > }
  > ```
  > 
  > And a comment like this in `file3.dart`:
  > ```dart
  > /// Refer to [MyOtherClass.field].
  > ```
  > 
  > And, crucially, `file3.dart` does *not* include `file2.dart` (but it's still a valid doc reference).
  > 
  > If I then rename `MyClass.field` to be `MyClass.somethingElse` using the IDE, I get the following change in file3.dart:
  > 
  > ```dart
  > /// Refer to [MyOtherClass.somethingElse].
  > ```
  > 
  > For a real world example of this, open the file `packages/flutter/lib/src/material/debug.dart` in the Flutter repo and insert this after the imports at the top:
  > 
  > ```dart
  > class MyWidget extends StatelessWidget {
  >   const MyWidget({this.children = const []});
  > 
  >   final List children;
  > 
  >   @override
  >   Widget build(BuildContext context) {
  >     return Column(children: children);
  >   }
  > }
  > ```
  > 
  > Then re
  > 
  > _(truncated)_

  * [#4129](https://github.com/Dart-Code/Dart-Code/issues/4129): **Go to Symbol in Workspace** no longer navigates to the parent library file when using `part`s.

  > **#4129**: "Go to Symbol in Workspace" navigates to wrong location `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > - [ ] Commit a0bfd8c6 needs reverting (+ version check adding?) once this is fixed.
  > 
  > Failing test:
  > 
  > ```
  > AssertionError [ERR_ASSERTION]: /home/runner/.pub-cache/git/protobuf.dart-53a1448f6da7a8035654cf502f1c62b45885bb63/protobuf/lib/protobuf.dart should end with /src/protobuf/protobuf_enum.dart)
  >       + expected - actual
  > ```
  > 
  > Can be reproduced by adding the `protobuf` package to a project then trying to navigate to `ProtobufEnum`. It takes you to the `lib/protobuf.dart` file which is not where the class is defined.
  > 
  > Issue might have started with Dart 2.18.

  * [#4121](https://github.com/Dart-Code/Dart-Code/issues/4121): Code folding regions that overlap the same line (such as parameter list and function bodies) have been adjusted since VS Code recently stopped supporting them.

  > **#4121**: Code folding not working properly in certain circumstances `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > 
  > At least in top-level functions, code folding can sometimes be unavailable. For example, I might be able to fold a function signature, but not the implementation block (and some but not all blocks within). While this is difficult to describe, it is most easily observed through reproduction or the videos below.
  > 
  > The issue does not appear to happen in Android Studio, so I'm guessing this is not an SDK issue (though VSCode can fold parameter lists, while Android Studio cannot--I'm not sure if this is intended).
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Clone https://github.com/flutter/flutter (head is f477c8b184d2364fcef0a15cee6ab5c909188229 at the time of writing)
  > 2. Open run_hot.dart (packages/flutter_tools/lib/src)
  > 3. Fold all code. This can be done by opening the command palette (Cmd/Ctrl+Shift+P) and typing _Fold All_.
  > 4. You should see multiple unfolded blocks of code. As a specific example, the body `_defaultReassembleHelper` won't be fo
  > 
  > _(truncated)_

  * [#4120](https://github.com/Dart-Code/Dart-Code/issues/4120): Hovering over a constructorâ€™s parameters no longer show an oversized font for the type.

  > **#4120**: Hovering over constructor's parameters shows an oversized font for the type `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > 
  > Hovering over constructor parameters (named or unnamed) shows an oversized font for the type. The same oversized appears when hovering over the name of an argument of a constructor with named parameters as seen below:
  > 
  > 
  > 
  > It gets a bit wild when the type is multiple `typedef`s (e.g. shelf's `Middleware` type)
  > 
  > 
  > 
  > **Expected behavior**
  > I would expect the same font size as when hovering over the member definition (this is a wide screenshot so it looks smaller)
  > 
  > 
  > 
  > 
  > **Please complete the following information:**
  > - VS Code version: Version: 1.70.1
  > - Dart extension version: v3.46.1
  > - Dart/Flutter SDK version: Dart SDK version: 2.17.6 (stable) (Tue Jul 12 12:54:37 2022 +0200) on "macos_x64"

  * [#4114](https://github.com/Dart-Code/Dart-Code/issues/4114): Navigation/resolution of DartDoc qualified references that reference members from a base class now work as expected.

  > **#4114**: Dartdoc bracketed references don't work for inherited members `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > ## Description
  > 
  > Bracketed references in dartdoc comments don't get highlighted if the field referred to is a superclass parameter.
  > 
  > For instance, if I have:
  > 
  > ```dart
  > /// The callback [TextButton.onPressed] will be called when the button is pressed.
  > ```
  > 
  > Then the bracketed reference to `TextButton.onPressed` _is not_ clickable, but:
  > 
  > ```dart
  > /// The callback [ButtonStyleButton.onPressed] will be called when the button is pressed.
  > ```
  > 
  > _is_ clickable. `ButtonStyleButton` is the superclass for `TextButton`.
  > 
  > I think this is because the `TextButton` class inherits its attribute from the parent via the `super.onPressed` argument in the constructor, but I can't be sure.
  > 
  > ## Version info
  > 
  >  - Operating System and version:
  > 	 - Debian GNU/Linux rodete 5.17.11-1rodete2-amd64
  >  - VS Code version:
  > 	  - Version: 1.70.2
  > 	  - Commit: e4503b30fc78200f846c62cf8091b76ff5547662
  > 	  - Date: 2022-08-16T05:36:25.715Z
  > 	  - Electron: 18.3.5
  > 	  - Chromium: 100.0.4896.160
  > 	  - Node.js
  > 
  > _(truncated)_

  * [#3182](https://github.com/Dart-Code/Dart-Code/issues/3182): Code completion now offers members that can be overridden when invoked in a completely empty class.

  > **#3182**: Completion for @override doesn't work well at the end of a class `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > DartCode is over-eager to offer class autocompletions to attributes. See the screenshot: here it should ideally be offering me `@override` as the completion, rather than trying to auto-import random classes from `dart:io` :) 
  > 
  > **To Reproduce**
  > Create a class, attempt to add an override (e.g. `toString()`)
  > 
  > **Expected behavior**
  > Either offer me autocomplete for available attributes, or don't offer me autocomplete. The proffered choices will always create a syntax error.
  > 
  > **Screenshots**
  > ![image](https://user-images.githubusercontent.com/2319867/110219796-29f38d00-7e76-11eb-9b43-6a88e3e020e0.png)
  > 
  > **Versions (please complete the following information):**
  >  - VS Code version: 1.54.1
  >  - Dart extension version: 3.20.1
  >  - Dart/Flutter SDK version: 2.0 stable
  > 
  > (preview LSP is on)

  * [#4184](https://github.com/Dart-Code/Dart-Code/issues/4184): The **Create missing override(s)** quickfix now shows in completely empty classes.

  > **#4184**: Create missing override(s) quickfix not showing for empty classes. `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > 
  > When creating an empty class that `extends` another one, the "Create n missing override(s)" quickfix is not appearing. In fact vscode says there are no quickfixes available at all. Once I write a single character inside the class, quickfixes start showing up.
  > 
  > This does not happen when using `implements`.
  > 
  > I'm not sure whether this is an extension or a language server issue. Feel free to close this and refer me to the correct repo.
  > 
  > **To Reproduce**
  > 
  > Steps to reproduce the behavior:
  > 1. Create an empty class that extends another class that has abstract methods.
  > 2. Press `cmd+.` anywhere in the class name.
  > 
  > **Expected behavior**
  > 
  > It should display the appropriate quickfixes.
  > 
  > **Screenshots**
  > 
  > ![image](https://user-images.githubusercontent.com/8726539/192542377-3f388fd3-47da-4429-99da-e500b085994e.png)
  > ![image](https://user-images.githubusercontent.com/8726539/192542418-614ce56c-0fb0-4e05-bb86-731e491f8813.png)
  > ![image](https://user-images.githu
  > 
  > _(truncated)_

  * [#4181](https://github.com/Dart-Code/Dart-Code/issues/4181): Links for the â€œSee code inâ€ example links in Flutter no longer return additional unexpected results when trying to navigate with **Go to Definition** / `ctrl` \+ click.

  > **#4181**: "See code in" example links incorrectly group multiple examples, don't linkify entire path `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > When navigating to an example in the Flutter repo source code in the form of:
  > 
  > ```dart
  > /// {@tool dartpad}
  > /// This example shows various [ClipRRect]s applied to containers.
  > ///
  > /// ** See code in examples/api/lib/widgets/basic/clip_rrect.0.dart **
  > /// {@end-tool}
  > /// ...
  > /// {@tool dartpad}
  > /// This example shows a [ClipRRect] that adds round corners to an image.
  > ///
  > /// ** See code in examples/api/lib/widgets/basic/clip_rrect.1.dart **
  > /// {@end-tool}
  > ```
  > 
  > If there are multiple examples in the comment then it says that there are two possible "definitions" for the destination, when the analyzer [should be supplying the full path](https://dart.googlesource.com/sdk/+/refs/heads/main/pkg/analyzer_plugin/lib/utilities/navigation/navigation_dart.dart#226) to the destination under the pointer, and so VSCode should be linkifying the entire path, not just the path element.
  > 
  > ![Screenshot from 2022-09-26 16-26-33](https://user-images.githubusercontent.com/8867023/192398582-46f
  > 
  > _(truncated)_

  * [#4169](https://github.com/Dart-Code/Dart-Code/issues/4169): The **Remove widget** assist is now available on widget calls prefixed with aliases.

  > **#4169**: "Remove widget" is not available when it's from a library imported with an alias `is bug` `in editor` `in lsp/analysis server`
  > **Describe the bug**
  > 
  > When a library is imported with an alias (ex: `import 'package:flutter/material.dart' as material;`), the option "Remove widget" is not available on the widget from this library (ex: `material.Center()`).
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Copy this code 
  >   ```dart
  >   import 'package:flutter/material.dart';
  >   import 'package:flutter/material.dart' as material;
  >   
  >   class MyWidget extends StatelessWidget {
  >     const MyWidget({Key? key}) : super(key: key);
  >   
  >     // This widget is the root of your application.
  >     @override
  >     Widget build(BuildContext context) {
  >       return const Center(
  >         child: material.Center(
  >           child: Text('Flutter'),
  >         ),
  >       );
  >     }
  >   }
  >   ```
  >   Or check out https://github.com/ValentinVignal/flutter_app_stable/tree/flutter-vscode/remove-widget.
  > 2. Toggle the code actions on `Center` and then on `material.Center`.
  > 3. Notice that the code action "Remove widget" is available fo
  > 
  > _(truncated)_

  * [#4167](https://github.com/Dart-Code/Dart-Code/issues/4167): The **Inline Method** refactor no longer fails if the method has type parameters.

  > **#4167**: "Inline Method" fails with type params `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > ```dart
  > void test(T a, T b) {
  >   print(a);
  >   print(b);
  > }
  > void f() {
  >   test(1, 2);
  > }
  > ```
  > 
  > Trying to inline this method results in "No argument for the parameter "a"., type: 1". Removing `` "fixes" it.

  * [#4157](https://github.com/Dart-Code/Dart-Code/issues/4157): **Find References** once again works when the caret is at the end of the symbol name (or the entire symbol name is selected). This issue only affected some recent pre-release versions of the SDK.

  > **#4157**: Find References doesn't work when selection covers an entire symbol `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > Double-clicking on a method name then pressing Shift+F12 doesn't find anything:
  > 
  > 
  > 
  > (same goes for putting the caret at the end of the name, which is likely the same offset for this selection).

  * [#4141](https://github.com/Dart-Code/Dart-Code/issues/4141): Hot Reload and Hot Restart now show progress notifications when using new SDK DAPs.

  > **#4141**: Hot Reload progress notifications don't show when using SDK DAPs `is bug` `in flutter` `in debugging`
  > These notifications are sent by the old DAP but not the new one, so the notifications never show.

  * [#4101](https://github.com/Dart-Code/Dart-Code/issues/4101): The Debug Console now focuses more quickly when launching an app using the new Flutter SDK DAP.

  > **#4101**: Debug Console does not focus immediately when using Flutter SDK DAP `is bug` `in flutter` `in debugging` `relies on sdk changes`
  > The `launchRequest` doesn't respond until `flutter` sends an `app.started` event, and VS code uses the response of that request to show the console. We should look at whether we need to delay responding to `launch` (or `attach`) until `app.started` occurs.

  * [#3966](https://github.com/Dart-Code/Dart-Code/issues/3966): DevTools no longer sometimes fails to open if a previous window had been closed within the last 30 seconds.

  > **#3966**: DevTools no longer opens in browser if a previous window was closed `is bug` `in devtools`
  > - run a debug session
  > - run the **Dart: Open DevTools** command
  > - select  **Open DevTools in Web Browser**
  > - close the browser window
  > - try to open again in the browser
  > - (nothing happens)
  > 
  > I think the DevTools server is not correctly handling the browser being closed, so it tries to reuse a connected client that doesn't exist (rather than launch a new one).

  * [#4149](https://github.com/Dart-Code/Dart-Code/issues/4149): Breakpoints will no longer fail to be hit on Windows when using SDK DAPs depending on the casing of the drive letter of the current working directory.

  > **#4149**: Breakpoints can fail on Windows when using SDK DAPs `is bug` `in debugging` `on windows` `relies on sdk changes`
  > See #4147. We're hitting https://github.com/dart-lang/sdk/issues/32222 again. In the local DAPs we normalise the paths, but the SDK DAPs do not.

