# Dart-Code v3-92

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.92.0 _2024-07-02_

## Flutter

  * [#5134](https://github.com/Dart-Code/Dart-Code/issues/5134): A new `flutter-default` web renderer option has been added and made the default. This setting will always use whatever the default renderer is for the current Flutter SDK, whereas the previous default `auto` setting will continue to select the renderer based on the device.

  > **#5134**: Add separate web renderer options for flutter-default and auto and set the default to flutter-default `is enhancement` `in web` `in flutter`
  > We are changing the default for `--web-renderer` in the flutter tool ([issue](https://github.com/flutter/flutter/issues/149826)). This PR is doing the same thing in the VSCode extension.
  > 
  > **_Question to reviewers:_**
  > I prefer to not hardcode a default value here, and instead omit the `--web-renderer` argument by default. That way, we let the flutter tool decide what's the default. Is there a way to make the `dart.flutterWebRenderer` enum nullable?

  * [#5119](https://github.com/Dart-Code/Dart-Code/issues/5119): Trying to install Flutter through the extension will no longer hang on “Checking for git…” if `git` cannot be found and is not on `PATH`. Instead, an appropriate error will be shown and a button linking to the online installation instructions.

  > **#5119**: Can't install Flutter SDK - Stuck on "Checking for git" `is bug` `in flutter`
  > Hello. I am trying to install Flutter, and have the most recent version of both Visual Studio and Git. I am stuck on the message "checking for git". It's my first time on VS. I am on Windows 11. Any help would be so very much appreciated. Thanks.

  * [#5127](https://github.com/Dart-Code/Dart-Code/issues/5127): When the Dart VM binary inside Flutter is a symlink (as it is for some Flutter package managers), Dart SDK update checks will no longer run. Dart SDK update checks are only relevant for standalone Dart SDKs as Flutter manages the version for Flutter SDKs.

  > **#5127**: Don't prompt for Dart SDK updates when Dart SDK is found from a symlink in a Flutter SDK `is enhancement` `in flutter`
  > **Is your feature request related to a problem? Please describe.**
  > Flutter 3.22.1 at this current date, is using Dart 3.4.1 while Dart 3.4.2 is already released.
  > 
  > Every project I open I receive this warning:
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/52160996/fd58294c-9521-4ad2-8f88-adcee06fed81)
  > 
  > **Describe the solution you'd like**
  > I'd like the following option to stop being a boolean value and having an array of options:
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/52160996/01a31786-50aa-4f9a-90c7-1816a47445df)
  > 
  > Options like:
  > - Always
  > - Latest Flutter bundled
  > - Never
  > 
  > **Describe alternatives you've considered**
  > Waiting for a new Flutter release and hope that it syncs again while the Dart SDK doesn't release another update.

  * [#5145](https://github.com/Dart-Code/Dart-Code/issues/5145): The iOS Language setting has been updated to indicate it will no longer apply for future Flutter SDKs (after 3.22) where Swift will always be used.

  > **#5145**: Remove --ios-language for Flutter > 3.22 and update setting description `is enhancement` `in flutter`
  > See https://github.com/flutter/flutter/issues/148586
  > See https://github.com/flutter/flutter/issues/148586#issuecomment-2137140743




## Testing

  * [#5094](https://github.com/Dart-Code/Dart-Code/issues/5094): VS Code’s new standard “Run Tests” / “Debug Tests” entries in the explorer context menu now work for Dart and Flutter projects.

  > **#5094**: VS Code's new "Run Tests" / "Debug Tests" entries in the explorer context menu do not work for Dart/Flutter `is bug` `in testing`
  > **Describe the bug**
  > Dart code unable to find the tests for a newly generated Flutter project
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 
  > Create a new Flutter project via flutter create your_example.
  > Open the folder via code
  > Select the generated test and right-mouse click on widget_test.dart and select Run Tests.
  > 
  > -> Message that no tests is found (see below for screenshot).
  > 
  > **Expected behavior**
  > 
  > Test found and run.
  > That is was what happened in the past, AFAICS this "test not found" is something new.
  > 
  > **Screenshots**
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/139910/adde2e76-c9e0-4aa2-a1cb-300cd727668f)
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/139910/502a977b-db68-4cec-aca2-c9c062c410c2)
  > 
  > **Please complete the following information:**
  > 
  > You can run the **Dart: Collect Diagnostic Information** command from the VS Code command palette (`F1`) to easily capture this information or provide it manually.
  > 
  > **!! ⚠️ PLEASE REVIEW THIS
  > 
  > _(truncated)_




## Commands

  * [#5126](https://github.com/Dart-Code/Dart-Code/issues/5126): The **Dart: Restart Analysis Server** command should no longer show multiple notifications about processes terminating that are expected behaviour during a restart.

  > **#5126**: `Restart Analysis Server` exits `DevTools` on Flutter projects `is bug` `in commands`
  > **Describe the bug**
  > When I run "Restart Analysis Server" from the extension, on Flutter projects (tested on a Dart-only project and it doesn't happen) I get an error from DevTools.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Run `flutter create bug`
  > 2. Open on VSCode
  > 3. Wait for the analysis server to finish starting
  > 4. Run "Restart Analysis Server"
  > 
  > **Expected behavior**
  > Nothing should be appearing.
  > 
  > **Screenshots**
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/52160996/3f6381fe-cdde-4c0c-a0fc-1bbfce368082)
  > 
  > **Please complete the following information:**
  > 
  > 
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.90.0
  > Flutter extension: 3.90.0 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: win 1.89.1
  > 
  > Workspace type: Flutter (LSP)
  > 
  > Dart (3.4.1): C:\Users\user\.puro\shared\caches\55eae6864b296dd9f43b2cc7577ec256e5c32a8d\dart-sdk
  > Flutter (3.22.1): C:\Users\user\.puro\envs\stable\flutter (Windows (windows-x64/windows))
  > 
  > 
  > _(truncated)_

  * [#5159](https://github.com/Dart-Code/Dart-Code/issues/5159): The **Dart: Use Recommended Settings** command now accepts a `{ showNotification?: boolean }` flag that can be used to suppress the confirmation message when invoked programatically (such as during cloud IDE initial setup).

  > **#5159**: Allow the "Dart: Use Recommended Settings" command to run silently `is enhancement` `in commands`
  > **Is your feature request related to a problem? Please describe.**
  > During workspace creation on IDX, we're looking to use Dart's recommended settings to give users the best experience out of the box. When we execute the command from our extension, it shows a dialog that clutters the creation flow. It would be helpful to be able to call the command silently.
  > 
  > **Describe the solution you'd like**
  > Add a "silent" flag to the "Use Recommended Settings" command that defaults to `false` but can be set to `true` when called programmatically from a different extension.
  > 
  > **Describe alternatives you've considered**
  > Maintaining a separate copy of the recommended settings in IDX that would need to be maintained to be kept in line with Dart's recommended settings.




## DevTools

  * [#5152](https://github.com/Dart-Code/Dart-Code/issues/5152): Some “Open DevTools” buttons/commands no longer silently fail when running the latest pre-release version of DevTools from source.

  > **#5152**: "Open DevTools (in Browser?)" option doesn't work `is bug` `important` `in devtools`
  > @kenzieschmoll has been seeing issues the last few days with the command palette command and the Sidebar title button not doing anything when trying to open DevTools. No errors are in the console.
  > 
  > I was just able to repro this, and switching back to the Stable version seemed to fix it. My guess would be that it's related to https://github.com/Dart-Code/Dart-Code/commit/3855d1d94150745e4800b3f1eb9945a0e3726fe5 or https://github.com/Dart-Code/Dart-Code/commit/eea9929f7c90f2991c60b0415c5a3cae38e432fa (they do have some changes in the commands to support the new flags, the change was not isolated to the commands).

  * [#5147](https://github.com/Dart-Code/Dart-Code/issues/5147): To support some upcoming changes to the Sidebar, the internal API now allows launching DevTools without supplying a debug session (in this case, a quick-pick will be shown to select a debug session or a single debug session will be selected automatically).

  > **#5147**: Support openDevTools over sidebar API without a debug session ID `is enhancement` `in devtools`
  > We can prompt for a debug session in VS Code if one isn't supplied.




## Misc

  * [#5133](https://github.com/Dart-Code/Dart-Code/issues/5133): Several legacy settings have been moved to the **Legacy** section in the settings UI and had their descriptions updated to make it clear those settings may only work for older SDKs.

  > **#5133**: Make it clearer which settings only apply to legacy analysis server protocol (additionalAnalyzerFileExtensions, analyzeAngularTemplates) `is enhancement` `in editor` `in docs / website`
  > Maybe move these into a "Legacy" category?

  * [#5151](https://github.com/Dart-Code/Dart-Code/issues/5151): Fixed a few small spelling mistakes in notification messages.
  * [#5150](https://github.com/Dart-Code/Dart-Code/issues/5150): Updated flutter.dev links to use new redirect URLs to avoid website changes potentially breaking them.

  > **#5150**: Update flutter.dev links to more reliable destinations
  > Contributes to https://github.com/flutter/website/issues/10363




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

  * [#5149](https://github.com/Dart-Code/Dart-Code/issues/5149): Closure completion suggestions now include types when the `always_specificy_types` lint is enabled.

  > **#5149**: Closure completion suggestions should include types when always_specificy_types lint is enabled `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > When using the `always_specify_types` lint, code snippets do not honour this setting.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Create a new Flutter project (I was using a Flutter specific piece of code completion to test)
  > 2. Paste the sample code into main.dart
  > ```dart
  > import 'package:flutter/widgets.dart';
  > 
  > void main() {
  >   final Widget futureBuilder = FutureBuilder(
  >     
  >   );
  > }
  > ```
  > 
  > 3. Enable `always_specify_types` in analysis_options.yaml
  > 4. In the code sample, put the cursor on the blank line between parentheses and press `b`
  > 5. Accept the `builder:` snippet by pressing enter
  > 6. Accept either of `(context, snapshot) =>` or `(context, snapshot) {}`
  > 7. The added snippet now lacks the types for the function parameters
  > ```dart
  > import 'package:flutter/widgets.dart';
  > 
  > void main() {
  >   final Widget futureBuilder = FutureBuilder(
  >     builder: (context, snapshot) {
  >       
  >     },
  >   );
  > }
  > ```
  > 
  > **Expected behavior**
  > The inserted
  > 
  > _(truncated)_

  * [#5142](https://github.com/Dart-Code/Dart-Code/issues/5142): The quick-fix for “Add missing switch cases” now adds all enum values instead of only the first.

  > **#5142**: Quick fix for "Add missing switch cases" does not add all quick fixes `is bug` `in editor` `relies on sdk changes`
  > **Describe the bug**
  > The quick fix for `Add missing switch cases` only adds one case at a time, instead of all of the missing cases.
  > I think this used to work before.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Use the given code sample
  > 2. Put the cursor on the switch keyword
  > 3. Open the assists / quick fixes menu in VSCode with the lightbulb
  > 4. Select `Add missing switch cases`
  > 5. Only one case is added, instead of all missing cases
  > 
  > ```dart
  > void main() {
  >   final ResultType resultType = ResultType.done;
  > 
  >   switch (resultType) {}
  > }
  > 
  > enum ResultType { done, error, other }
  > ```
  > 
  > **Expected behavior**
  > Since the quick fix indicates `Add missing switch cases` (note plural) I would expect the quick fix to add all of the missing ones.
  > 
  > **Screenshots**
  > ![Screenshot 2024-06-13 at 13 58 58](https://github.com/Dart-Code/Dart-Code/assets/23480364/547074f9-42a1-4850-9456-640df6963dde)
  > 
  > ![Screenshot 2024-06-13 at 13 59 09](https://github.com/Dart-Code/Dart-Code/a
  > 
  > _(truncated)_

  * [#5139](https://github.com/Dart-Code/Dart-Code/issues/5139): Multiline string literals are now foldable.

  > **#5139**: [Feature request] Make multi-line string literals foldable `is enhancement` `in editor` `relies on sdk changes`
  > Consider a multi-line string in a .dart file:
  > 
  > ```dart
  > final bigString = '''
  > I am a multiline string.
  > I might be really long.
  > For example, I could be an entire Android manifest (the XML you would find in an AndroidManifest.xml file)
  > that's defined in a test file.
  > '''
  > ```
  > 
  > It would be nice if I could fold this. This is something I can do with multi-line string literals in JS/TS:
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/9027551/3ea86868-820f-4173-ab51-e6a354aa08c7)
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/9027551/96943237-f886-4a75-b7ec-7f1fbaa0037d)
  > 
  > **Describe alternatives you've considered**
  > The user can manually create folding regions using the "Create Folding Range from Selection", but it's generally not worth the time to do this.

  * [#5128](https://github.com/Dart-Code/Dart-Code/issues/5128): Debugger views no longer show duplicates when a class hierarchy contains both fields and getters with the same name.

  > **#5128**: Duplicate fields in debugger view `is bug` `in debugging` `relies on sdk changes`
  > **Describe the bug**
  > 
  > In this debugger variable view, of a RevenueCat object hierarchy, you can see a bunch of duplicate field entries:
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/811305/b93af2fc-cbd9-484e-a895-15a16deda2dc)
  > 
  > The `_$OfferingImpl` class that contains the fields that are displayed duplicated is a "Freezed" generated class.
  > 
  > **To Reproduce**
  > 
  > You'd have to set up a whole RevenueCat-enabled project to reproduce these conditions, so reproducing this may be a lot of work...
  > 
  > **Expected behavior**
  > 
  > Fields should only ever show once
  > 
  > **Please complete the following information:**
  > 
  > 
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.89.20240513
  > Flutter extension: 3.89.20240501 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: linux 1.89.1
  > 
  > Workspace type: Dart, Flutter (LSP) (Multiroot)
  > 
  > Dart (3.4.0-282.3.beta): /opt/flutter/bin/cache/dart-sdk
  > Flutter (3.22.0-0.3.pre): /opt/flutter (Pixel 7 Pro (android-arm64/androi
  > 
  > _(truncated)_

  * [#4868](https://github.com/Dart-Code/Dart-Code/issues/4868): “Find all references” now treats field formal parameters as references to fields.

  > **#4868**: "Find all references" does not treat field formal parameters as references to fields `is bug` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > 
  > "Find all references" seems to discriminate between `this.` parameters and the fields they map to. I don't think there should be a distinction.
  > 
  > **To Reproduce**
  > 
  > Create these two classes:
  > 
  > ```dart
  > class X {
  >   int x;  // (1)
  >   X({required this.x});  // (2)
  > }
  > 
  > class Y {
  >   void foo() {
  >     X(x: 1);  // (3)
  >   }
  > }
  > ```
  > 
  > **Actual behavior**
  > 
  > The numbers (1), (2), and (3) infer positioning the cursor at `x` on the correspondingly numbered line, and then right-clicking and selecting "Find all references":
  > 
  > * "Find all references" at (1) finds only (1) and (2).
  > * "Find all references" at (2) finds only (1) and (3).
  > * "Find all references" at (3) finds only (2) and (3).
  > 
  > **Expected behavior**
  > 
  > "Find all references" at any of (1), (2), or (3) should find all three.
  > 
  > (Dart 3.3.0 on Linux)

  * [#4743](https://github.com/Dart-Code/Dart-Code/issues/4743): Flutter structured error summaries (shown when multiple errors occur since the last reload) are no longer missing information about the error-causing widget.

  > **#4743**: Bad structured errors text `is bug` `in flutter` `in debugging` `relies on sdk changes`
  > Using the code at https://github.com/DanTup/devtools/tree/bad-structured-errors, running the sidebar results in this error that appears to be missing information:
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/1078012/42d6bfd4-b9c4-41b8-a9a4-4b4f9dc940c5)
  > 
  > Specifically, it says "The relevant error-causing widget was:" but has nothing after it.

  * [#4734](https://github.com/Dart-Code/Dart-Code/issues/4734): Breakpoints are now resolved eagerly and should turn red (if valid) immediately rather than only when the function first executes. Additionally, an issue that could cause breakpoints to appear to jump to the wrong line (even though internally they were still set on the requested line) has been resolved.

  > **#4734**: Breakpoints are not resolved (they appear greyed in the editor) until just before they are executed `is bug` `in debugging` `relies on sdk changes`
  > **Describe the bug**
  > I have a Dart API project, and I can't create breakpoints after updating to v3.72.2. There is no issue with v3.70.0.
  > 
  > **Expected behavior**
  > Be able to create breakpoint
  > 
  > **Screenshots**
  > 
  > 
  >  - Operating System and version: macOS Ventura Version 13.5.2 (22G91)
  >  - VS Code version: 1.82.0
  >  - Dart extension version: v3.72.2
  >  - Dart/Flutter SDK version:  Dart 3.1.1 / Flutter 3.13.3
  >  
  >  
  > ```
  > !! PLEASE REVIEW THIS LOG FOR SENSITIVE INFORMATION BEFORE SHARING !!
  > 
  > Dart Code extension: 3.72.2
  > Flutter extension: 3.72.0 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: 1.82.0
  > Platform: mac
  > 
  > Workspace type: Dart
  > Analyzer type: LSP
  > Multi-root?: true
  > 
  > Dart SDK:
  >     Loc: /Users/hasimyerlikaya/flutter/bin/cache/dart-sdk
  >     Ver: 3.1.1
  > Flutter SDK:
  >     Loc: /Users/hasimyerlikaya/flutter
  >     Ver: 3.13.3
  > 
  > HTTP_PROXY: undefined
  > NO_PROXY: undefined
  > 
  > Logging Categories:
  >     General, AnalyzerTiming, CommandProcesses, DartTest, DAP, VmSer
  > 
  > _(truncated)_

  * [#5124](https://github.com/Dart-Code/Dart-Code/issues/5124): When attaching to Flutter web fails, the “Attaching…” notification no longer stays on screen and the failure message is now visible in the Debug Console.

  > **#5124**: When attaching to Flutter web fails, the "Attaching..." notification stays on screen and the error message is not shown `is bug` `in flutter` `in debugging` `relies on sdk changes`
  > When triggering the issue at https://github.com/flutter/flutter/issues/149258 from the IDE, there is no feedback that it's failed, and the toast notification stays there forever.
  > 
  > We should handle the `app.stop` event and close any launching progress events and print the error.
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/1078012/07f0c262-a80f-41a9-92b3-1f1f1be9e2c6)

