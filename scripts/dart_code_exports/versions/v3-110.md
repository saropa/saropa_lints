# Dart-Code v3-110

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.110.0 _2025-05-01_

## Flutter

  * [#5494](https://github.com/Dart-Code/Dart-Code/issues/5494): When enabling a new platform for a project, default files like `test/test_main.dart` are no longer recreated.

  > **#5494**: When asking to add a platform to a project, it should use `flutter create --empty` `is enhancement` `in flutter`
  > **Describe the bug**
  > When I run a project on a platform that isn't currently supported by the project, the extension asks me to add the desired platforms, which makes sense.
  > 
  > But when it adds it, it uses the `flutter create --platform=linux` command, which not only adds the platform, it also creates things like a test/main_test.dart, which are unrelated to adding a platform, and are confusing if you already have a project with a main.dart, but no test called main_test.dart, since now you have a test that fails if you run it, and you have no idea where that came from.
  > 
  > The `flutter create` command has an `--empty` argument which limits the creation of new files and simplifies the files it does create to the minimum.
  > 
  > Adding platforms should use that.
  > 
  > The `--empty` arg should probably write fewer things too (it currently writes a plain README.md which is unnecessary), but that's not an extension bug.
  > 
  > _(truncated)_

  * [#5498](https://github.com/Dart-Code/Dart-Code/issues/5498): After selecting to enable a new platform, an additional confirmation prompt is no longer shown and the platform is enabled immediately.

  > **#5498**: Remove unnecessary prompt when enabling platforms `is enhancement` `in flutter`
  > When clicking an entry like "Enable Android for this project" in the device picker, we pop up an additional conformation toast before executing `flutter create`. This prompt doesn't serve any process but is easy to mess because you may be looking at the quick-pick at the top of the screen. We should just remove this extra prompt and run the command immediately.




## Commands

  * [#5500](https://github.com/Dart-Code/Dart-Code/issues/5500): The “Copy VM Service URI” command now provides options to copy both internal and exposed URIs when running in a remote session (such as SSH or Firebase Studio).

  > **#5500**: Support "Copy VM Service URI" better in remote workspaces `is enhancement` `in commands`
  > When running the "Copy VM Service URI" command (from the palette or from the language status area), we'll prompt if there are multiple debug sessions, but we don't let you choose between local + remote URIs (eg. you always get "localhost" addresses in a context like IDX).
  > 
  > Instead, we should populate the picker with both local+remote entries for each debug session (if they differ), and therefore should show the picker even for a single debug session in a remote workspace to let you choose between local/remote address.

  * [#5501](https://github.com/Dart-Code/Dart-Code/issues/5501): The “Copy VM Service URI” command no longer shows an error stating that there are no debug sessions available if you cancel from the debug session prompt.

  > **#5501**: "Copy VM Service URI" incorrectly says there are no sessions if you cancel the prompt `is bug`
  > - Start 2 debug sessions
  > - Run "Copy VM Service URI"
  > - When prompted to select a debug session, press Esc or move focus away
  > - You are shown an incorrect toast notification (instead, it should silently cancel)
  > 
  > ![Image](https://github.com/user-attachments/assets/31098cb5-d988-4f8d-9264-f11dc4f19995)




## Testing

  * [#5489](https://github.com/Dart-Code/Dart-Code/issues/5489): In multi-root workspaces, workspace folder names are now included in the test runner tree labels.

  > **#5489**: Include workspace folder names in test runner suite labels `is enhancement` `in testing`
  > In this workspace, I have multiple folders (`analysis_server`, `analyzer` etc.), but because we only show relative paths from the workspace folder, you can't tell them apart:
  > 
  > ![Image](https://github.com/user-attachments/assets/a4eb0e00-7822-43fa-be11-177a2f58b82b)
  > 
  > When in a multiroot workspace, we should include the name of the workspace folder too.

  * [#5488](https://github.com/Dart-Code/Dart-Code/issues/5488): Test suites are no longer sometimes duplicated in the test runner if they are both discovered statically and provide test results during a debug session.

  > **#5488**: Test labels are different in the test runner after running `is bug` `in testing`
  > I ran some of these tests by right-clicking on the "test/src/computer" folder (in `analysis_server`), and then when I switched to the test runner, they appear as just the filename, whereas the other discovered tests all have relative paths from the root of the workspace folder.
  > 
  > ![Image](https://github.com/user-attachments/assets/b1d59ba9-1ffe-4340-9edb-ee0834df48f9)




## Misc

  * [#5490](https://github.com/Dart-Code/Dart-Code/issues/5490): `analysis_options.yaml` and `.dart_tool` have been added to the list of files that trigger activation of the Dart Extension. This may help the extension activate earlier when opening some workspaces where Dart projects are deeply nested if one of these files/folders still exist within the top few levels.

  > **#5490**: Extension does not activate for deeply-nested workspaces with analysis_options.yaml in the top 3 levels `is bug`
  > **Describe the bug**
  > 
  > The Dart extension does not issue all expected `flutter pub get` commands and does not analyze the source tree the same way depending on whether, after cloning a repository, a specific folder or a subfolder has been opened as workspace root.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. `git clone --no-checkout https://github.com/flutter/packages.git`
  > 2. `cd packages`, `get sparse-checkout init --cone`, `get sparse-checkout set packages/camera packages/google_maps_flutter` (this restricts checkout, so that things are faster and easier to repro)
  > 3. `code .`
  > 4. At this point, no `flutter pub get` is proposed by the Dart-Code extension, and the analyzer does not run.
  > 5. I now open a .dart file (for instance: `packages/camera/camera_android/lib/src/android_camera.dart`). 'flutter pub get' is proposed now. Is this exact behaviour expected?
  > 6. Regardless, let 'flutter pub get' commands be issued and let the analyzer run for a while. It will be quick since there 
  > 
  > _(truncated)_

  * [#5320](https://github.com/Dart-Code/Dart-Code/issues/5320): Starting with the upcoming v1.100 of VS Code (not the Dart extension), autocompletion in YAML files will automatically trigger when typing.

  > **#5320**: Yaml autocompletion does not work in VS Code `is bug` `in editor` `fixed in vs code`
  > **Describe the bug**
  > Autocompletion for `analysis_options.yaml` (and other yaml files) and not work on typing (but works on a shortcut, `option + esc` in my case).
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Open any analysis_options file
  > 2. Start typing
  > 
  > **Please complete the following information:**
  > 
  > Dart Code extension: 3.98.1
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: mac 1.94.2
  > 
  > Workspace type: Dart (LSP)
  > Workspace name: dart-code-metrics-teams
  > 
  > Dart (3.5.1): /Users/incendial/Desktop/flutter/bin/cache/dart-sdk
  > Flutter (3.24.1): /Users/incendial/Desktop/flutter (No device)




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

  * [#5496](https://github.com/Dart-Code/Dart-Code/issues/5496): “An error occurred while handling textDocument/rename request” no longer occurs when renaming a closure parameter.

  > **#5496**: An error occurred while handling textDocument/rename request `is bug` `upstream in dart / flutter`
  > **Renaming element name in iterable.map is not working**
  > 
  > **To Reproduce**
  > 1. Call `.map` to an iterable like below.
  > ```Dart
  > final List list = [];
  > final list2 = list.map((element) => element).toList();
  > ```
  > 
  > 2. Rename the `element` to something else using `F2` key.
  > 
  > 3. Nothing happens and there is a warning/error popup stating `An error occurred while handling textDocument/rename request`.
  > 
  > **Expected behavior**
  > Variable is renamed.
  > 
  > **Screenshots**
  > 
  > **Please complete the following information:**
  > ```
  > Dart Code extension: 3.109.20250404
  > Flutter extension: 3.109.20250401 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: mac 1.99.3
  > 
  > Workspace type: Flutter (LSP)
  > Workspace name: tokowijaya
  > 
  > Dart (3.7.0): /Users/dikatok/flutter/bin/cache/dart-sdk
  > Flutter (3.29.1): /Users/dikatok/flutter (No device)
  > ```

