# Dart-Code v3-102

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.102.0 _2024-12-02_

## Flutter

  * [#5353](https://github.com/Dart-Code/Dart-Code/issues/5353): The “Peek Error” popup shown when a test fails now shows the full output of a test instead of only the last output event (which for Flutter integration tests is often just the bottom of an ascii box `==========================`).

  > **#5353**: VS Code Testing UI Bug, test fail output "═════..." `is bug` `in flutter` `in testing`
  > **Describe the bug**
  > When writing a test that is not inside /test folder, the output of a failing test is "═════..." (take a look at the screenshot)
  > 
  > the debug console displays the correct exception
  > 
  > 
  > **To Reproduce**
  > flutter create
  > 
  > enter the sample code into the test file integration_test/widget_test.dart
  > 
  > hint: the official flutter tutorial for integration tests also creates it inside /integration_test folder
  > https://docs.flutter.dev/testing/integration-tests#create-the-integration-test-files 
  > 
  > and another hint, because this is a flutter vscode bug I was advised to open the issue here
  > https://github.com/flutter/flutter/issues/159264
  > 
  > **Expected behavior**
  > Displaying the correct exception into the vscode ui
  > 
  > **Code Sample**
  > 
  > ```dart
  > import 'package:flutter/material.dart';
  > import 'package:flutter_test/flutter_test.dart';
  > 
  > Future main() async {
  >   group(
  >     "integration test",
  >     () {
  >       testWidgets("test1", (WidgetTester tester) async {
  >         await
  > 
  > _(truncated)_




## Editor

  * [#5327](https://github.com/Dart-Code/Dart-Code/issues/5327): The TextMate grammar (used for syntax highlighting before semantic tokens are available and for themes that do not support semantic tokens) has been updated to resolve some issues with unclosed code blocks in documentation comments.

  > **#5327**: Update syntax highlighting to improve code blocks in dartdocs `is enhancement` `in editor`
  > We want the fix for https://github.com/dart-lang/dart-syntax-highlight/pull/75 to fix this:
  > 
  > ![image](https://github.com/user-attachments/assets/662c547d-2d85-4863-b69e-ae1a0be237df)

  * [#5345](https://github.com/Dart-Code/Dart-Code/issues/5345): The warning shown when `dart.sdkPath` or `dart.flutterSdkPath` contain an invalid path has been updated to include the path in the message to make it easier to spot issues like unescaped backslashes if pasting Windows paths into the JSON settings file.

  > **#5345**: Analyzer path settings shows different message than sdks when invalid `is bug` `in editor`
  > After setting `analyzerPath` for the first time I got:
  > 
  > ```console
  > Could not find a Dart Analysis Server at C:\Users\felip_0vh5fa6\Documents\Projects\dart\bug\C:serselip_0vh5fa6ocumentsrojectslonesart-sdk2dkkgnalysis_serverinerver.dart
  > ```
  > 
  > The current project path:
  > 
  > ```
  > C:\Users\felip_0vh5fa6\Documents\Projects\dart\bug\
  > ```
  > 
  > And this is what I've placed on the variable:
  > 
  > ```json
  > "dart.analyzerPath": "C:/Users/felip_0vh5fa6/Documents/Projects/clones/dart-sdk2/sdk/pkg/analysis_server/bin/server.dart"
  > ```
  > 
  > After some talk on Discord. I'd like to request that it shows a similar message as when the SDK path is not valid. Not displaying the full output. Or doing so for the other path settings.
  > 
  > ---
  > 
  > Also, I'd like to request that these paths that accept the use of `~/path/to/something` also say so in the description. Similar to the description for the log files.




## Debugger

  * [#5252](https://github.com/Dart-Code/Dart-Code/issues/5252): Threads/isolates in the debugger will no longer sometimes show incorrect paused/resumed state when multiple isolates are used.

  > **#5252**: Race condition when using multiple isolates `is bug` `in debugging`
  > **Describe the bug**
  > Breakpoints don't work with multiple isolates unless a post-frame callback is used.
  > Related to microsoft/vscode#5220.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Run the code sample on macOS.
  > 2. Set a breakpoint on `Widget build(BuildContext context) {`.
  > 3. Click FAB.
  > 
  > **Expected behavior**
  > Program breaks on breakpoint after each push of the FAB.
  > 
  > 
  > Code sample
  > 
  > ```dart
  > import 'dart:isolate';
  > 
  > import 'package:flutter/foundation.dart';
  > import 'package:flutter/material.dart';
  > 
  > void main() {
  >   runApp(const MyApp());
  > }
  > 
  > void _isolateEntryPoint(Map message) {
  >   final sendPort = message['sendPort'] as SendPort;
  >   Isolate.exit(sendPort, null);
  > }
  > 
  > class MyApp extends StatelessWidget {
  >   const MyApp({super.key});
  > 
  >   @override
  >   Widget build(BuildContext context) {
  >     return MaterialApp(
  >       title: 'Isolates bug',
  >       theme: ThemeData(
  >         colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepPurple),
  >         useMat
  > 
  > _(truncated)_




## Docs / website

  * [#5348](https://github.com/Dart-Code/Dart-Code/issues/5348): The [settings page](/docs/settings/) has been updated to include a number of previously-missing settings.
  * [#5347](https://github.com/Dart-Code/Dart-Code/issues/5347): The descriptions for many path settings (such as `dart.analyzerPath`) have been updated to note when `~` can be used to indicate the home directory.

  > **#5347**: Update config docs to note that ~ can be used in additional settings like analyzerPath `is enhancement` `in docs / website`
  > Split from https://github.com/Dart-Code/Dart-Code/issues/5345




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

[#3941](https://github.com/Dart-Code/Dart-Code/issues/3941): Code completion now shows color previews inline.

  > **#3941**: Show color previews in code completion `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > See https://github.com/dart-lang/sdk/issues/48870#issuecomment-1109617492.


![](/images/release_notes/v3.102/completion_colors.png)

[#5326](https://github.com/Dart-Code/Dart-Code/issues/5326)/[#5346](https://github.com/Dart-Code/Dart-Code/issues/5346): [@FMorschel](https://github.com/FMorschel) contributed a new analysis server command “Go to Imports” that shows all of the import directives that import a given identifier into the current file. This can be invoked from the command palette or context menu.

  > **#5326**: Wire up "Go to Imports" command `is enhancement` `in editor` `relies on sdk changes`
  > @FMorschel is working on adding a custom LSP command to get the imports for an element at a cursor location (https://github.com/dart-lang/sdk/issues/56584). We need to register a command to invoke it from here (similar to "Go to Super").
  > 
  > We should also ensure it only shows up when using an SDK that supports it (from the registered command, which we probably already do for some others).


![](/images/release_notes/v3.102/imports.gif)

  * [#5324](https://github.com/Dart-Code/Dart-Code/issues/5324): The `label` custom semantic token modifier is now correctly applied to argument names when the type is `dynamic`.

  > **#5324**: Dart code in vscode semantic token type seems wired. `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > Hello there，
  >  there are some issues when custom my vscode code hightlight.
  > ![image](https://github.com/user-attachments/assets/f46084f5-e95e-4c86-8dd3-0e72775461dd)
  > 
  > I think both key1 and key2 are parameter.label , but why doesn't key1 have modifiers? How can I fix this, thank you.
  > 
  > 
  > 
  > environment:
  > Dart Code extension: 3.98.1
  > Flutter extension: 3.98.0 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: win 1.94.2

  * [#4794](https://github.com/Dart-Code/Dart-Code/issues/4794): Code completion now works correctly on enums that are imported with a prefix.

  > **#4794**: Autocomplete doesn't work properly with enums when using named imports `is bug` `fixed in dart / flutter` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > 
  > When using named imports, auto completing enum doesn't show the value but prompt to insert a switch condition as shown below: 
  > 
  > 
  > **To Reproduce**
  > 
  > 
  > 
  > 
  > ```dart
  > import 'dart:ui' as ui;
  > 
  > void main() {
  >   final x = ui.BlendMod  // <~~ auto complete here
  > }
  > ```
  > 
  > **Expected behavior**
  > 
  > I expect the enum values to be shown 
  > 
  > **Please complete the following information:**
  > Extension version: v3.74.0
  > VS Code version: 1.83.1
  > Flutter 3.13.6 • channel stable • 
  > Dart 3.1.3 • DevTools 2.25.0

  * [#5165](https://github.com/Dart-Code/Dart-Code/issues/5165): Several issues have been fixed in Flutter that could cause `flutter_test` processes to be leaked when terminating a test run.

  > **#5165**: Hanging flutter_tester processes `is bug` `fixed in dart / flutter` `in flutter` `in testing`
  > **Describe the bug**
  > The flutter_tester processes aren't terminated.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Run multiple tests with breakpoints
  > 2. Exit in the middle of the execution
  > 
  > **Expected behavior**
  > The flutter_tester processes are terminated
  > 
  > **Screenshots**
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/46357905/83a3babd-8d02-46e8-b7e4-b714db737eee)
  > 
  > ```text
  > Dart Code extension: 3.90.0
  > Flutter extension: 3.90.0 (activated)
  > 
  > App: Code - OSS
  > App Host: desktop
  > Version: linux 1.90.0
  > 
  > Workspace type: Flutter (LSP)
  > 
  > Dart (3.3.1): /home/alexandre/fvm/versions/3.19.3/bin/cache/dart-sdk
  > Flutter (3.19.3): /home/alexandre/fvm/versions/3.19.3 (Linux (linux-x64/linux))
  > 
  > ```

