# Dart-Code v3-106

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.106.0 _2025-03-03_

## Old SDK Support

[#5325](https://github.com/Dart-Code/Dart-Code/issues/5325): As [previously announced](https://groups.google.com/g/flutter-announce/c/JQHzM3FbBGI), support for Dart SDK v2.19 / Flutter SDK v3.7 and earlier has been removed in this version (v3.106) of the extension. If you need to use these older SDK versions you will need to install v3.104. The [SDK Compatibility page](/sdk-version-compatibility/) maintains a table of which extension versions support which SDKs.

  > **#5325**: Remove support for < 3.0 SDKs and legacy analyzer protocol `is enhancement`
  > - [x] Always use LSP
  > - [x] Update the website to note which extension versions deprecate and remove support for older SDKs
  > - [x] Clean up legacy protocol code that's no longer used


## Editor

  * [#5326](https://github.com/Dart-Code/Dart-Code/issues/5326): A new **Dart: Go to Imports** command has been added that allows jumping to the `import` directive(s) that provide a given symbol/identifier.

  > **#5326**: Wire up "Go to Imports" command `is enhancement` `in editor` `relies on sdk changes`
  > @FMorschel is working on adding a custom LSP command to get the imports for an element at a cursor location (https://github.com/dart-lang/sdk/issues/56584). We need to register a command to invoke it from here (similar to "Go to Super").
  > 
  > We should also ensure it only shows up when using an SDK that supports it (from the registered command, which we probably already do for some others).

  * [#5423](https://github.com/Dart-Code/Dart-Code/issues/5423): Debug Adapter traffic is no longer captured when using the **Dart: Capture Analysis Server Logs** command.

  > **#5423**: DAP traffic is recorded in "Capture Analysis Server Logs" `is bug` `in editor` `in debugging`
  > When capturing analysis server logs during a debug session, the debugger traffic is being recorded.
  > 
  > ```
  > Workspace type: Dart (LSP)
  > Workspace name: dart_sample
  > 
  > Dart (3.8.0-edge.282ea5868bf91f3f6b850b45afd4d1332c3ba901): D:\Tools\Dart\Latest (Bleeding Edge)
  > Flutter (3.30.0-1.0.pre.150): D:\Dev\Google\Flutter\Flutter main (No device)
  > 
  > Logging Categories:
  >     General, Analyzer, CommandProcesses
  > 
  > Thu Feb 20 2025 [17:51:44 GMT+0000 (Greenwich Mean Time)] Log file started
  > // ...
  > [5:51:48 PM] [General] [Info] [Dart ]  [VM] {"jsonrpc":"2.0","id":"7","method":"getVM","params":{}}
  > [5:51:48 PM] [General] [Info] [Dart ]  [VM] {"jsonrpc":"2.0","id":"8","method":"requirePermissionToResume","params":{"onPauseStart":true,"onPauseReload":false,"onPauseExit":true}}
  > [5:51:48 PM] [General] [Info] [Dart ]  [VM] {"jsonrpc":"2.0","id":"9","method":"getDartDevelopmentServiceVersion","params":{}}
  > [5:51:48 PM] [General] [Info] [Dart ]  [VM] {"jsonrpc":"2.0","id":"10","method":"requireUserPermissionToResume","p
  > 
  > _(truncated)_

  * [#2470](https://github.com/Dart-Code/Dart-Code/issues/2470): The presence of an `analysis_options.yaml` inside a `lib/` folder no longer prevents auto-import code completions from working correctly.

  > **#2470**: analysis_options.yaml in lib folder breaks auto-import and quick-fixes `is bug` `in editor` `in lsp/analysis server`
  > Hello, after I upgraded the VS Code plug-in for Flutter and Flutter & Dart, the automatic import and quick repair functions failed!
  > 
  > Before I upgrade, I enter the class name under lib / or the API name exposed in the third-party package will automatically import its file.
  > 
  > For example, if I enter `StatelessWidget`, multiple options will appear:
  > 
  > -Import from `package: flutter / material.dart`.
  > -Import from `package: flutter / widgets.dart`.
  > ...
  > 
  > But now there is no response after input! Just prompt me for the correct Class name, but it will no longer be automatically imported after clicking!
  > 
  > Before, when I manually input "StatelessWidget", for example, after the mouse is placed in the class name position, there will be multiple imported quick fixes! But now it is gone!
  > 
  > ** I have n’t made any changes to the settings of the plugin **, it worked fine before, but it no longer works!
  > 
  > This is my plugin settings:
  > 
  > ![image](https://user-images.githubusercontent.com/5564821
  > 
  > _(truncated)_




## Debugger

  * [#4727](https://github.com/Dart-Code/Dart-Code/issues/4727): Stack traces in the debug console now have clickable links for SDK `_patch.dart` files.

  > **#4727**: Stack traces in the debug console do not show links for "_patch" files  `is bug` `in flutter` `in debugging`
  > **Describe the bug**
  > 
  > Sometimes when a Dart stacktrace is printed to the debug console, it is not parsed properly by VS Code. For example:
  > 
  > ```console
  > #0      ProfileInfoEndpoint._getAllUserInfo (package:click_server/src/endpoints/profile_endpoint.dart:29:7)
  > 
  > #1      ProfileInfoEndpoint.updateProfile (package:click_server/src/endpoints/profile_endpoint.dart:49:9)
  > 
  > #2      EndpointDispatch.handleUriCall (package:serverpod/src/server/endpoint_dispatch.dart:111:20)
  > 
  > #3      Server._handleRequest (package:serverpod/src/server/server.dart:243:18)
  > 
  > ```
  > 
  > For this stacktrace, the filename and line numbers are not identified and linked in the debug console by VS Code. They are treated simply as text.
  > 
  > In this stacktrace, also from the debug console, some of the lines are correctly linked back to source (shown indented on a new line here, but shown as right-justified links in the debug console window in VS Code), and some are not:
  > 
  > ```console
  > E/flutter (10117): #0      List.[
  > 
  > _(truncated)_

  * [#4853](https://github.com/Dart-Code/Dart-Code/issues/4853): Compilation errors in the debug console now have clickable links to the related source.

  > **#4853**: Compilation error lines are not linked in stderr output `is enhancement` `in editor` `in debugging`
  > If you try to run a program and there are compilation errors, the errors are sent to stderr, but they are not linked by Dart-Code:
  > 
  > ![image](https://github.com/Dart-Code/Dart-Code/assets/811305/c4a58733-2797-4066-bb04-0ab52f05312b)
  > 
  > It would be really helpful to have these lines linked. Thanks!




## Testing

  * [#5390](https://github.com/Dart-Code/Dart-Code/issues/5390): The bubble shown to summarize failed tests now shows both expected and actual values when both are simple one-line values.

  > **#5390**: Improve the summary bubble for failed tests when expected/actual values are simple/single-line `is enhancement` `in testing`
  > **Expected behavior**
  > When a test failed, it shows this red tag in the editor with the expected result. While the idea is really good as the tag would highlight the test that failed, the text the shows is completely useless and redundant as I can actually see what's the expect result on the file. What I can not see in the file however, the actual result that I got from the test execution. I need to to click the red tag which opens a sort of a popup that shows details about the unit.
  > 
  > **Screenshots**
  > 
  > 
  > I think it would be more useful if the red tag showed the actual result instead of the expected one. I looked through preferences to see if i could configure it but I did not find anything. What you do you think?
  > 
  > And sorry if this is unrelated to this repo or if it is not the right place.
  > Thanks




## Flutter

  * [#5411](https://github.com/Dart-Code/Dart-Code/issues/5411): Enabling a new device now automatically selects it after enabling.

  > **#5411**: Enabling a desktop device does not automatically select it `is bug` `in flutter`
  > If I create a new project and then click to "Enable Windows", the device selector doesn't automatically update or select it afterwards:
  > 
  > ![Image](https://github.com/user-attachments/assets/6d55e1e7-813d-45b8-b288-b6d799ba5cb8)
  > 
  > ![Image](https://github.com/user-attachments/assets/4b422843-91af-46ee-9b80-46aee67717bd)




## Misc

  * [#5420](https://github.com/Dart-Code/Dart-Code/issues/5420): The **Open in Xcode** action no longer fails if Xcode is installed on a removable drive.

  > **#5420**: Opening XCode fails `is bug`
  > **Describe the bug**
  > Opening XCode from "Open in XCode" option fails to open XCode if it was not identified in the terminal/ if XCode is installed in External Drive.
  > 
  > Making use of `-a` argument in open command would fix it.
  > ```bash
  > open -a XCode 
  > ```
  > 
  > **To Reproduce**
  > 1. Install Xcode in External drive
  > 2. Try opening `ios project` via Termianl/VSCode
  > 
  > **Expected behavior**
  > Should open XCode
  > 
  > **Please complete the following information:**
  > 
  > **!! ⚠️ PLEASE REVIEW THIS REPORT FOR SENSITIVE INFORMATION BEFORE SHARING ⚠️ !!**
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.104.0
  > Flutter extension: 3.104.0 (activated)
  > 
  > App: Trae
  > App Host: desktop
  > Version: mac 1.96.4
  > 
  > Workspace type: Flutter (LSP)
  > Workspace name: nlearnv4
  > 
  > Dart (3.7.0): /opt/homebrew/Caskroom/flutter/3.29.0/flutter/bin/cache/dart-sdk
  > Flutter (3.29.0): /opt/homebrew/Caskroom/flutter/3.29.0/flutter (iPhone 16 Pro Max (ios/ios))
  > 
  > ```
  > 
  > Output from 'dart info'
  > 
  > _(truncated)_

  * [#5328](https://github.com/Dart-Code/Dart-Code/issues/5328): The error message shown when the analysis server crashes has been improved, including a **Show Log** button that shows the server output.

  > **#5328**: Improve VS Code's error when the Dart analyzer crashes `is enhancement`
  > **Is your feature request related to a problem? Please describe.**
  > If the Dart analyzer crashes, VS code recommends `See the output for more information`:
  > 
  > ![image](https://github.com/user-attachments/assets/970eed2f-fd37-45c6-a7ce-689a5928ed25)
  > 
  > However, the output pane is not helpful:
  > 
  > ![image](https://github.com/user-attachments/assets/8989c5ea-77f4-42cb-9fbf-142e7249d345)
  > 
  > **Describe the solution you'd like**
  > VS Code should recommend using the `Dart: Capture logs` VS Code command and should link to this guide: https://dartcode.org/docs/logging/
  > 
  > Perhaps this should also recommend cleaning the Dart analyzer cache (deleting `~/.dartServer/` on macOS)
  > 
  > **Describe alternatives you've considered**
  > N/A
  > 
  > **Additional context**
  > N/A

  * [#5376](https://github.com/Dart-Code/Dart-Code/issues/5376): The error message shown when running the analysis server from source with a mismatched SDK version has been improved.

  > **#5376**: Analysis server crash if analyzer from source doesn't match the sdk version limits - better explanation for the user `is enhancement`
  > **Describe the bug**
  > When running the analyzer from source, we have a limitation on the version of the SDK which is running it. When you change the version to one that is not compatible, the server fails multiple times and the three toast errors that come up (every time and it keeps trying to make it work without success), only the analyzer toast (that sends you to the analyzer log file now) gives a good-ish (weird phrasing for the versions but I could gather that was something about the versions and the path for my source was displayed there) explanation as to what is going on.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Add a valid value for `analyzerPath` and `sdkPath`
  > 2. Change the `sdkPath` to a version incompatible with the analyzer
  > 
  > **Expected behavior**
  > I'd expect a better exception message. Maybe a fallback: 
  > - Warn the analyzer is not compatible and run without it.
  > - Warn that is not compatible and don't try to restart the server




## DevTools

  * [#5276](https://github.com/Dart-Code/Dart-Code/issues/5276)/[#5406](https://github.com/Dart-Code/Dart-Code/issues/5406): Embedded DevTools pages no longer try to adapt to the editor font size but instead follow the surrounding VS Code UI (including zoom scaling). This should result in more consistent font sizing.

  > **#5276**: Embedded DevTools pages have larger than expected text `is bug`
  > **Describe the bug**
  > Widget Inspector incompatible size in vscode.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Go to run 'main.dart'
  > 2. Click on 'Widget Inspector'
  > 
  > **Expected behavior**
  > I wish Widget Inspector can properly support the size.
  > 
  > **Screenshots**
  > ![image](https://github.com/user-attachments/assets/6582fda9-a657-45aa-af2f-04a0a476765e)
  > 
  > **Please complete the following information:**
  > 
  > You can run the **Dart: Collect Diagnostic Information** command from the VS Code command palette (`F1`) to easily capture this information or provide it manually.
  > 
  >  - Operating System and version:
  >  - VS Code version:on windows / "Windows 10 Enterprise" 10.0 (Build 19045)
  >  - Dart extension version: 3.96.0
  >  - Dart/Flutter SDK version: 3.97.20240902 (activated)
  >  - Target device (if the issue relates to Flutter debugging):(Windows (windows-x64/windows))




## Dart Tooling Daemon

  * [#5403](https://github.com/Dart-Code/Dart-Code/issues/5403): A new setting `dart.toolingDaemonAdditionalArgs` allows configuring additional arguments to pass to the Dart Tooling Daemon, for example to pass an explicit port with `--port`.

  > **#5403**: Prevent DTD from cluttering the VS Code Ports section with previously forwarded ports `is enhancement` `in dtd`
  > **Is your feature request related to a problem? Please describe.**
  > The DTD process listens on a random port when it starts. VS Code automatically forwards this port and lists it in the Ports section of the IDE. Each time VS Code is closed and reopened, a new DTD process starts, and a new port is forwarded. Over time, this leads to an accumulation of previously forwarded ports, making it difficult to identify the ports of interest.
  > 
  > **Describe the solution you'd like**
  > It is possible to specify the port that DTD listens to. The solution would be to allow the Dart VS Code extension to configure this port in `settings.json`. This way, DTD will always listen on the same port, preventing clutter in the Ports section.
  > 
  > https://github.com/dart-lang/sdk/blob/d209ea93337ce858359abc50ebed428a0eab0a41/pkg/dtd_impl/lib/dart_tooling_daemon.dart#L34-L37
  > 
  > _(truncated)_




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

  * [#5421](https://github.com/Dart-Code/Dart-Code/issues/5421): `test`/`group` snippets now automatically add imports for `package:test/test.dart` or `package:flutter_test/flutter_test.dart` if not already present.

  > **#5421**: `test`/`group` snippets do not add required imports automatically `is bug` `in lsp/analysis server` `relies on sdk changes`
  > can the sniped `test` for dart:
  > ``` Dart
  >   test('test name', () {
  >     
  >   });
  > ```
  > include `import 'package:test/test.dart';` if not already included?

  * [#5387](https://github.com/Dart-Code/Dart-Code/issues/5387): Projects using Pub Workspaces will no longer fail to resolve breakpoints when running on the web.

  > **#5387**: Unverified breakpoints running web in a workspace `is bug` `fixed in dart / flutter` `in web` `in debugging` `relies on sdk changes`
  > **Describe the bug**
  > When running flutter in web inside a workspace, the breakpoints keep being unverified
  > It's not possible to debug with breakpoints
  > 
  > **To Reproduce**
  > Create a dart workspace with 2 flutter projects
  > Run a project in web
  > Add a breakpoint
  > The breakpoint will stay unverified
  > 
  > **Expected behavior**
  > Breakpoints should work the same in a workspace as in a normal project
  > 
  >  - Operating System and version: macOS 15.1.1 (24B91)
  >  - VS Code version: 1.96.2
  >  - Dart extension version: 3.102.0
  >  - Dart/Flutter SDK version: 3.6.0 / 3.27.1
  >  - Target device (if the issue relates to Flutter debugging): Chrome 131.0.6778.205

  * [#5314](https://github.com/Dart-Code/Dart-Code/issues/5314): Unresolved (greyed) breakpoints will now contain a tooltip indicating if they are just not yet resolved, or if they are unable to be resolved (for example because they are in an invalid location).

  > **#5314**: Include breakpoint error reason in tooltip when breakpoints cannot be set `is enhancement` `in debugging` `relies on sdk changes`
  > With the fix for https://github.com/dart-lang/sdk/issues/56820 / https://github.com/Dart-Code/Dart-Code/issues/5157, the breakpoint will no longer be set. The VM returns us a reason:
  > 
  > ```js
  > {
  > 	"jsonrpc": "2.0",
  > 	"error": {
  > 		"code": 102,
  > 		"message": "Cannot add breakpoint",
  > 		"data": {
  > 			"request": {
  > 				"method": "addBreakpointWithScriptUri",
  > 				"params": {
  > 					"isolateId": "isolates/49774056015291",
  > 					"scriptUri": "file:///D:/Dev/Test%20Projects/dartcode_5157/bin/dartcode_5157.dart",
  > 					"line": "8"
  > 				}
  > 			},
  > 			"details": "addBreakpointWithScriptUri: Cannot add breakpoint at line 8. Error occurred when resolving breakpoint location: No debuggable code where breakpoint was requested."
  > 		}
  > 	},
  > 	"id": "15"
  > }
  > ```
  > 
  > We should wire this up to the `reason` field on the breakpoint so that it shows if the user hovers over the grey breakpoint.

  * [#5238](https://github.com/Dart-Code/Dart-Code/issues/5238): [@FMorschel](https://github.com/FMorschel) contributed a fix for auto-imports not adding to the `show` combinator of an existing import when selected.

  > **#5238**: Bug report: Auto complete doesn't add import to show clause `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Describe the bug**
  > Completing a symbol name does not add it in the import show clause.  Therefore, becoming very hard to use explicit imports with a show clause all the time.
  > 
  > **Steps to reproduce the behavior:**
  > 1. Write part of an existing class name and press the key to complete the class name
  > ![image](https://github.com/user-attachments/assets/e55178a6-292c-45b7-a889-d1fc103ea1d6)
  > 
  > 2. Press Enter to confirm and check it's not imported
  > ![image](https://github.com/user-attachments/assets/3dcf2c22-817e-4ef3-835f-58406198a519)
  > 
  > 
  > **Expected behavior**
  > The symbol should be imported and highlighted correctly.
  > ![image](https://github.com/user-attachments/assets/f4cdf325-7185-4a47-8191-d9359dff82d0)
  > 
  >  - Operating System and version: Windows 11 (Build 22631)
  >  - VS Code version: 1.92.2
  >  - Dart extension version: 3.94.0
  >  - Dart/Flutter SDK version: 3.94.0

  * [#4454](https://github.com/Dart-Code/Dart-Code/issues/4454): `.new` references to the unnamed constructor are now highlighted correctly with other references to the same constructor (and the declaration).

  > **#4454**: Incorrect highlighting of other occurrences with "new" default constructor references `is bug` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > While investigating #4436, I noticed this odd highlighting:
  > 
  > ![Mar-23-2023 10-00-09](https://user-images.githubusercontent.com/1078012/227168671-52e266b1-1eee-4085-b252-33f70a3eb152.gif)
  > 
  > 
  > ```
  > ==> {
  > 	"jsonrpc": "2.0",
  > 	"id": 213,
  > 	"method": "textDocument/documentHighlight",
  > 	"params": {
  > 		"textDocument": {
  > 			"uri": "file:///Users/danny/Dev/TestStuff/dart-code-metrics/lib/src/analyzers/lint_analyzer/rules/rules_factory.dart"
  > 		},
  > 		"position": {
  > 			"line": 167,
  > 			"character": 7
  > 		}
  > 	},
  > 	"clientRequestTime": 1679565486647
  > }
  > 
  > <== {
  > 	"id": 213,
  > 	"jsonrpc": "2.0",
  > 	"result": [
  > 		{
  > 			"range": {
  > 				"end": {
  > 					"character": 16,
  > 					"line": 168
  > 				},
  > 				"start": {
  > 					"character": 70,
  > 					"line": 166
  > 				}
  > 			}
  > 		}
  > 	]
  > }
  > ```

  * [#5426](https://github.com/Dart-Code/Dart-Code/issues/5426): When debugging, floating values (“inline values”) will be shown for the values of local variables and parameters in the current executing function.

  > **#5426**: Support "Inline Values" when debugging `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > There's an issue in the SDK for the server implementation of this, but we should ensure it's called out in release notes here.
  > 
  > https://github.com/dart-lang/sdk/issues/59891
  > 
  > Basic implementation for variables/parameters looks like this:
  > 
  > https://github.com/user-attachments/assets/516cd462-7a4c-4a6d-8273-f4d6e52b2f43
  > 
  > Feedback should be collected in https://github.com/dart-lang/sdk/issues/59891

  * [#2785](https://github.com/Dart-Code/Dart-Code/issues/2785): Package names in `pubspec.yaml` have document links (can be Ctrl+Clicked) to open the relevant Pub.dev or GitHub pages in a browser.

  > **#2785**: Suggestion: Open pub.dev link from pubspec.yaml `is enhancement` `in editor` `in lsp/analysis server`
  > Hope this is the right place for a suggestion.
  > 
  > It would be nice if the popup menu of a dependency in the pubspec.yaml has a option to open `https://pub.dev/packages/` directly.

