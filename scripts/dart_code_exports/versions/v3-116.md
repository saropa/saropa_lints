# Dart-Code v3-116

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.116.0 _2025-07-31_

## Code Coverage for Flutter tests

[#2860](https://github.com/Dart-Code/Dart-Code/issues/2860): It’s now possible to run tests while capturing coverage in Flutter projects. The “Run With Coverage” option appears in the test runner toolbar as well as against each individual test suite/test.

  > **#2860**: Code Coverage Visualization for Flutter `is enhancement` `in flutter` `in testing` `in coverage`
  > ## 1. Is your feature request related to a problem? Please describe it
  > 
  > I've been working on a package that has hundreds of tests, so an easy way of visualizing code coverage would be incredibly handy.
  > 
  > ## 2. Describe the solution you'd like
  > 
  > I would like to run my tests with, say, a `.vscode` configuration with an `lcov.info` output which would automatically be recognized by VS Code and highlighted on the respective editors with either red or green.
  > 
  > ## 3. Describe alternatives you've considered
  > 
  > I've tried many different solutions in the past few days &mdash; months actually &mdash; but none of them worked as the ideal one described above:
  > 
  > - `flutter test --coverage --coverage-path=lcov.info` does work to generate the necessary file, but it's clunky to have to visualize it through a 3rd party program such as `genhtml`, all the more if you're on Windows.
  >     - And it does need Flutter in the end, which should not be necessary if you're working on pure Dart...
  > - IntelliJ
  > 
  > _(truncated)_


![](/images/release_notes/v3.116/run_with_coverage_test_explorer.png)

It also appears on the menu from the test gutter icons.

![](/images/release_notes/v3.116/run_with_coverage.png)

Coverage data will show in the gutter, and expand to highlight lines when hovered over. It’s also shown in the Explorer tree and the Test Coverage when on the Testing sidebar.

![](/images/release_notes/v3.116/coverage_in_editor.png)

## Flutter

  * [#5612](https://github.com/Dart-Code/Dart-Code/issues/5612)/[#5617](https://github.com/Dart-Code/Dart-Code/issues/5617): Adding a Flutter project to a workspace that previously contained only Dart projects will now prompt to reload in order to switch to a Flutter SDK and start required Flutter services.

  > **#5612**: "Unable to launch Flutter project in a Dart-only workspace" when trying to launch a Flutter app added to a non-Flutter workspace `is bug` `in flutter` `in debugging`
  > At around 46:00 in https://www.youtube.com/watch?v=EsklFa3nkwA, trying to run the project with CodeLens resulted in:
  > 
  > > "Unable to launch Flutter project in a Dart-only workspace"
  > 
  > My guess is that the workspace was opened without a Flutter project initially, so we detected the workspace as Dart-only, and then when a Flutter project was later added, we didn't update.
  > 
  > When in a Dart workspace, we should watch for `pubspec.yaml` being updated/created and check again if this is a Flutter project. If we need to upgrade from Dart to Flutter, we need to perform an extension restart (since we may need to find a Flutter SDK whereas before we might have only had a Dart one).
  > 
  > (cc @craiglabenz @RandalSchwartz)

  * [#5606](https://github.com/Dart-Code/Dart-Code/issues/5606)/[#5610](https://github.com/Dart-Code/Dart-Code/issues/5610): Interaction with Flutter’s device daemon has been switched to newer APIs, avoiding “No devices found” on Flutter’s `master` branch.

  > **#5606**: Devices aren't appearing when I click the menu in the bottom-right corner. `is bug` `in flutter` `important`
  > unsure if this should be filed under the SDK issue tracker. 
  > 
  > **Describe the bug**
  > 
  > Devices aren't appearing when I click the menu in the bottom-right corner.
  > 
  > **To Reproduce**
  > 
  > Steps to reproduce the behavior:
  > 
  > 1. Go to 'Devices' (Bottom-Right)
  > 2. Click on it.
  > 3. Devices doesn't show up, instead it shows enable `` for this project
  > 
  > I noticed this today on master 3.33.0-1.0.pre-1123. It wasn’t happening yesterday on 3.33.0-1.0.pre-1094. Stable is fine.
  > 
  > **Expected behavior**
  > 
  > It should show the list of devices.
  > 
  > **Screenshots**
  > 
  > https://github.com/user-attachments/assets/9c9036de-9a96-470f-8639-37781bcb44cd
  > 
  > **Please complete the following information:**
  > 
  >  - Operating System and version: macOS 15.5 24F74 darwin-arm64
  >  - VS Code version: 1.102.2 (Universal)
  >  - Dart extension version: 3.114.0, 
  >  - Flutter extension version: 3.114.2
  >  - Dart/Flutter SDK version: 3.33.0-1.0.pre-1123
  > 
  > _(truncated)_

  * [#5591](https://github.com/Dart-Code/Dart-Code/issues/5591): The **Flutter: New Project** command no longer shows the “Skeleton” option that was removed in Flutter 3.29.

  > **#5591**: Flutter: New Project shows "Skeleton" option that does not exist since Flutter 3.29 `is bug` `in flutter` `in commands`
  > **Is your feature request related to a problem? Please describe.**
  > When creating a Flutter project, there are several options as for the template. One of them is "Skeleton Application". However, this template has been removed from `flutter create` at the end of 2024 (see [skeleton template removal](https://github.com/flutter/flutter/issues/160673)).
  > 
  > **Describe the solution you'd like**
  > As this option doesn't exist in `flutter create` anymore, it should probably be removed from the choices in project creation from the Flutter plugin as well.
  > 
  > **Describe alternatives you've considered**
  > If too many people still use older versions of Flutter that still provide the (working) option for "Skeleton Templates", removing it could be postponed.
  > It could also be synched with the removal of the [skeleton] template option from the `flutter create` command, which is still present (but only shows a message instead of creating a project).




## Dependencies Tree

[#5589](https://github.com/Dart-Code/Dart-Code/issues/5589)/[#5590](https://github.com/Dart-Code/Dart-Code/issues/5590): The Dependencies tree now includes an “Open on Pub” command on the context menu to quickly open the pub.dev page for a package.

  > **#5589**: Add links to pub packages in dependencies tree `is enhancement` `in views`
  > We have links in `pubspec.yaml` to packages, so maybe we should also have them here?


![](/images/release_notes/v3.116/open_on_pub.png)

## Tasks

  * [#5572](https://github.com/Dart-Code/Dart-Code/issues/5572): [@mernen](https://github.com/mernen) contribute a fix for background task patterns for the `pkg:build_runner` tasks.

  > **#5572**: Update background task patterns for build_runner 2.5.0 `is enhancement` `in tasks`
  > `build_runner` v2.5.0 changed the output format. The relevant new messages are:
  > 
  > Starting new build:
  > https://github.com/dart-lang/build/blob/8f9939f3c804edb91d4df33045536f6894472af0/build_runner_core/lib/src/logging/build_log.dart#L388-L390
  > 
  > Success/failure:
  > https://github.com/dart-lang/build/blob/8f9939f3c804edb91d4df33045536f6894472af0/build_runner_core/lib/src/logging/build_log.dart#L58-L62C41
  > 
  > The old background patterns are kept, since projects may keep using older versions of `build_runner` for a long while. I don't expect them to interfere with each other.
  > 
  > (As far as I can tell, there are no tests for problem matchers?)
  > 
  > Also: I didn't change the problem matchers, only the background ones. I don't think it's possible to build a single matcher that works with both old and new outputs, and even if we were to have two separate `problemMatcher`s, I'm not sure if the output can be properly described, since error messages are often multiline.
  > 
  > AFAIK the only consequence
  > 
  > _(truncated)_




## Debugger

## Dart-Code Extension API

  * [#5008](https://github.com/Dart-Code/Dart-Code/issues/5008)/[#5583](https://github.com/Dart-Code/Dart-Code/issues/5583)/[#5595](https://github.com/Dart-Code/Dart-Code/issues/5595)/[#5601](https://github.com/Dart-Code/Dart-Code/issues/5601): New APIs are now exported by the extension to allow other VS Code extensions to reuse some of Dart-Code’s functionality. The internal private APIs that were intended only for testing (but had been adopted by some extensions) will be removed in an upcoming release. If you maintain a VS Code extension that uses these APIs, please see https://github.com/Dart-Code/Dart-Code/issues/5587 and ensure your extension is migrated.

  > **#5008**: Expose APIs for other VS Code extensions to use functionality from the Dart extension `is enhancement` `in api`
  > **Is your feature request related to a problem? Please describe.**
  > Not exactly a problem, but extensions depending on dart LSP will make this feature request more profitable. Exposing required/specific data would be more helpful.
  > 
  > **Describe the solution you'd like**
  > Exposing analyzer.
  > 
  > **Additional context**
  > In my case, we are building the [fluttergpt](https://marketplace.visualstudio.com/items?itemName=WelltestedAI.fluttergpt) extension, which will utilize the dart LSP. [This](https://github.com/Dart-Code/Dart-Code/commit/d8f943d8bcc10834262155a057ae412fb29fab52) had become a blocker for us. Ref: https://github.com/Welltested-AI/dash-ai/issues/224




## Misc

  * [#5586](https://github.com/Dart-Code/Dart-Code/issues/5586): An issue in the Dart SDK that could result in “The system cannot find the file specified” when tests has been resolved.

  > **#5586**: "The system cannot find the file specified" when running analysis server test `upstream in dart / flutter`
  > When trying to run this file with Ctrl+F5 I get this error:
  > 
  > This might be related to the change to use the test runner, but I'm pretty sure I've run many test files since then.

  * [#5581](https://github.com/Dart-Code/Dart-Code/issues/5581): An improved error message is shown if you try to use a Dart SDK built for a different architecture.

  > **#5581**: When setting a different architecture Dart SDK at the path, the extension shows no error `is bug`
  > **Describe the bug**
  > When on Windows x64, I've accidentally downloaded the ARM version of the Dart SDK and told my project to use it. When opening that project again, the extension shows nothing and, of course, doesn't start the analysis server.
  > 
  > **To Reproduce**
  > Steps to reproduce the behaviour (probably any combination of SDKs will do the same, but I've not tested):
  > 1. Download the ARM version of the Dart SDK on a Windows x64 machine
  > 2. Set that path for the SDK to a project and restart the extension
  > 
  > **Expected behavior**
  > _Some_ error to show up.

  * [#5604](https://github.com/Dart-Code/Dart-Code/issues/5604)/[#5607](https://github.com/Dart-Code/Dart-Code/issues/5607): Dart-Code’s own test files can now be run individually using `npm run test src/test/path/to/test_file.test.ts`.

  > **#5604**: Support running individual test files from Dart-Code's test suite `is enhancement`
  > Currently when you run `npm test` it runs all tests (either for all bots, or for a single bot if the `BOT` env var is set).
  > 
  > It would be convenient to be able to run individual files with `npm test foo` and have it run any of the test files that contain "foo".
  > 
  > To do this, we need to:
  > 
  > - ensure `npm test` passes any additional args to `npm test-only`
  > - ensure `npm test-only` passes the additional args to `./out/src/test/test_all.js` (and ideally skip `npm run test-grammar` if args are passed)
  > - have `test_all.ts` (which compiles to `test_all.js`) pass these args in an env variable when invoking `vstest.runTests`
  > - read the env variable in `test_runner.ts` (which is imported into each test suites `index.ts` to tun tests) and include it in the pattern used for locating the test files
  > 
  > To verify this is done, set `BOT=dart` and try tunning some of the test files like:
  > 
  > ```
  > npm test autolaunch
  > ```
  > 
  > This should run only the files from `dart/debug/autolaunch.test.ts`.
  > 
  > _(truncated)_

  * [#5614](https://github.com/Dart-Code/Dart-Code/issues/5614)/[#5615](https://github.com/Dart-Code/Dart-Code/issues/5615): The `autolaunch.json` functionality now supports waiting for a VM Service to become available before starting the debug session.

  > **#5614**: When auto-attaching with a VM Service URI, support probing for some time (~30s?) to ensure the VM Service is accessible before starting the debug session `is enhancement` `in debugging`
  > To help avoid timing issues with autolaunch.json, when we are provided with a VM Service URI, we should support probing it from the extension to ensure it's accessible before we try to start a debug session. This way we can just start up later rather than failing if we react to the file before the service is fully accessible. We should make this opt-in with a flag:
  > 
  > ```js
  > {
  >   "type": "dart",
  >   "request": "attach",
  >   "name": "Attach to Flutter",
  >   "vmServiceUri": "ws://xxx",
  >   "waitForVmServiceMs": 30000, // number of ms to wait for vmServiceUri to become accessible
  > 
  > }
  > ```
  > 
  > cc @keertip

  * [#5621](https://github.com/Dart-Code/Dart-Code/issues/5621)/[#5622](https://github.com/Dart-Code/Dart-Code/issues/5622): The `autolaunch.json` functionality now supports watching for modifications to the autolaunch file instead of only creation.
  * [#5613](https://github.com/Dart-Code/Dart-Code/issues/5613): An environment variable `DART_CODE_SERVICE_ACTIVATION_DELAY` can now be used to delay the activation of background services like the Dart Tooling Daemon.

  > **#5613**: Add an env variable to allow delaying startup of external services `is enhancement` `in remote` `on cloud ide`
  > There's currently an issue on Firebase Studio that prevents services that bind to ports really early on in the activate() method from being reachable correctly from the front-end. As a workaround while this is debugged, we should support a custom delay before we spawn things like DTD.
  > 
  > To avoid cluttering the users User or Workspace settings with this, we'll use an env variable that contains the number of milliseconds to delay startup of these services:
  > 
  > ```sh
  > DART_CODE_SERVICE_ACTIVATION_DELAY=5000
  > ```
  > 
  > cc @keertip
  > 
  > ---
  > 
  > **Edit:** Let's also support a hidden setting for this to simplify testing on cloud IDEs.

  * [#5585](https://github.com/Dart-Code/Dart-Code/issues/5585): The Dart SDK’s MCP server is now enabled by default when available.

  > **#5585**: Enable MCP server by default when available `is enhancement`
  > Flip the default value of `dart.mcpServer` (in both `package.json` and `config.ts`) so that it'll be registered by default.

  * [#5556](https://github.com/Dart-Code/Dart-Code/issues/5556)/[#5577](https://github.com/Dart-Code/Dart-Code/issues/5577): A new setting `dart.mcpServerLogFile` allows logging communication with the Dart SDK MCP server.

  > **#5556**: Add the a log file setting for the MCP server `is enhancement` `in ai`
  > See https://github.com/dart-lang/ai/issues/171
  > 
  > We need this to roll into the SDK before we can test it.
  > 
  > I think it's safe to assume that the flag exists if the user has configured a log file (eg. don't worry about trying to figure out exactly which version number has support for this flag.. few people will set this flag and those that do will almost certainly be on some future stable version that includes the flag, or bleeding edge that will have it once we implement this).

  * [#5471](https://github.com/Dart-Code/Dart-Code/issues/5471): Many fixes have been made to Dart SDK tests that would previously fail when run through the VS Code test runner.

  > **#5471**: Many tests in the SDK do not work through the test runner `is bug` `in testing`
  > In the latest release, we removed the code that forced the SDK repo to always run tests through `dart` instead of the test runner. It turns out there are quite a few tests in the SDK that fail when run through the runner.
  > 
  > Some are being discussed in https://github.com/dart-lang/sdk/issues/60437#issuecomment-2766543347, but I also found some analysis server integration tests fail too (unsure if this is Windows-specific or not, but I suspect not):
  > 
  > ![Image](https://github.com/user-attachments/assets/206ded61-1552-44ca-810c-89bcb8e18df9)
  > 
  > ![Image](https://github.com/user-attachments/assets/78299d2d-6427-4818-a1bb-c946783a56ff)
  > 
  > We should first try to update these tests to work with the test runner, but if it proves not to be trivial, we should consider putting the flag back for now.




## Features/Fixes Enabled with Future SDKs

The following items depend on changes to the Dart/Flutter SDKs that have not yet been released to stable channels. They may be available to test in the current beta/master channels and will show up in future SDK releases.

  * [#5588](https://github.com/Dart-Code/Dart-Code/issues/5588): Ctrl+Click to open the pub.dev page for dependencies listed in `pubspec.yaml` now works for the `dependency_overrides` section in addition to `dependencies`/`dev_dependencies`.

  > **#5588**: Open pub in `dependency_overrides` `is enhancement` `in editor` `in lsp/analysis server` `relies on sdk changes`
  > **Is your feature request related to a problem? Please describe.**
  > When overriding dependencies, I usually don't have them directly; they are transitive. After https://github.com/Dart-Code/Dart-Code/issues/2785 we can see the links to pub and similar on `dependencies` and `dev_dependencies` but not `dependency_overrides`.
  > 
  > **Describe the solution you'd like**
  > For `dependency_overrides` to also show a link to pub.
  > 
  > **Describe alternatives you've considered**
  > Opening it manually.

