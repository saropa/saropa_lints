# Dart-Code v3-128

For instructions on installing the Dart or Flutter extensions, [go here](/#installation).

# v3.128.0 _2026-02-02_

## Testing

[#5858](https://github.com/Dart-Code/Dart-Code/issues/5858)/[#5871](https://github.com/Dart-Code/Dart-Code/issues/5871): The Test Explorer now groups test suites under workspace/package folders, making tests in large workspaces easier to navigate.

  > **#5858**: Feature Request: Group tests by workspace folder + package `is enhancement` `in testing`
  > ## Description
  > 
  > In a multi-root VS Code workspace with multiple Flutter/Dart projects, the Test Explorer shows all tests in a flat list without grouping them by workspace folder. This makes it difficult to identify which tests belong to which project in monorepo setups.
  > 
  > ## Current Behavior
  > 
  > Tests are listed by file path without workspace folder grouping:
  > ```
  > ðŸ“„ admin/test/auth_test.dart
  >   â””â”€â”€ AuthService
  > ðŸ“„ mobile/test/auth_test.dart
  >   â””â”€â”€ AuthService  
  > ðŸ“„ admin/test/user_test.dart
  >   â””â”€â”€ UserService
  > ```
  > 
  > Tests from different projects are interleaved, making it confusing to identify which project a test belongs to, especially when test names are similar.
  > 
  > ## Desired Behavior
  > 
  > Tests grouped under workspace folder nodes (similar to Source Control view):
  > ```
  > ðŸŒ Admin (Flutter Web)
  >   â””â”€â”€ ðŸ“„ auth_test.dart
  >       â””â”€â”€ AuthService
  >   â””â”€â”€ ðŸ“„ user_test.dart
  >       â””â”€â”€ UserService
  > ðŸ“± Mobile (Flutter)
  >   â””â”€â”€ ðŸ“„ auth_test.dart
  >       â””â”€â”€ AuthService
  > ```
  > 
  > _(truncated)_


![](/images/release_notes/v3.128/test_tree.png)

  * [#5879](https://github.com/Dart-Code/Dart-Code/issues/5879)/[#5891](https://github.com/Dart-Code/Dart-Code/issues/5891): Running specific tests no longer triggers discovery of all tests suites before launching.

  > **#5879**: First test run in a session triggers slow discovery of all test suites `in testing` `is performance`
  > **Describe the bug**
  > After running a test file with `test_reflective_loader`, I see all gutter icons just fine, but if I right-click to debug a specific test, I see the `Discovering Tests...` status for a very long time. 
  > Simply restarting the extension host reproduces it. I don't need to edit anything to see this behaviour (tested on the SDK just now).
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Open a `test_reflective_loader` test file
  > 2. Run it fully
  > 3. Try using the gutter icon to debug a single test
  > 
  > **Expected behavior**
  > For it to immediately start the debugger (not needing to discover tests).
  > 
  > **Extra**
  > I'll see if I can profile the extension to send some more info here.
  > 
  > **Please complete the following information:**
  > 
  > Workspace Environment
  > 
  > ```text
  > Dart Code extension: 3.127.20260115
  > Flutter extension: 3.127.20251229 (activated)
  > 
  > App: Visual Studio Code
  > App Host: desktop
  > Version: win 1.108.1
  > 
  > Workspace type: Dart (LSP)
  > Workspace name: essential_lints
  > 
  > _(truncated)_

  * [#5883](https://github.com/Dart-Code/Dart-Code/issues/5883)/[#5878](https://github.com/Dart-Code/Dart-Code/issues/5878): Tracking of test locations (for gutter icons, etc.) now works across editors being closed and re-opened as long as the locations remain valid (and the file wasnâ€™t modified on disk).

  > **#5883**: Persist test tracking even if a document is closed `is bug fix` `in testing`
  > Otherwise closing and re-opening a file will stop it from updating.
  > 
  > There is a chance that a file is modified while it was closed, but I don't think there's a way to handle this (since we don't get proper edits).
  > 
  > Fixes https://github.com/Dart-Code/Dart-Code/issues/5878

  * [#5798](https://github.com/Dart-Code/Dart-Code/issues/5798)/[#5875](https://github.com/Dart-Code/Dart-Code/issues/5875): Dart tests now collect coverage across all related packages in the workspace (matching the behaviour for Flutter tests), as long as the project uses `package:test` version 1.29.0 or later.

  > **#5798**: Support collecting coverage for other packages in the workspace for Dart, like Flutter has `is enhancement` `in dart` `in testing`
  > When collecting coverage for Flutter, we collect it for all of the packages in the workspace (via `--coverage-package`). However that flag is not yet supported for Dart (see https://github.com/dart-lang/sdk/issues/60958#issuecomment-3528426345).




## Flutter

  * [#5854](https://github.com/Dart-Code/Dart-Code/issues/5854)/[#5867](https://github.com/Dart-Code/Dart-Code/issues/5867): The `deviceId` and `emulatorId` fields in `launch.json` now support substring matches and matching on device ID and name.

  > **#5854**: No longer able to specify devices by partial name in `deviceId` field in launch.json `is bug` `in flutter`
  > **Title:** Unable to specify Android device ID via launch.json in VS Code for Flutter development
  > 
  > **Describe the bug**
  > Starting from a certain version, it has become impossible to run applications by specifying Android device IDs via launch.json in VS Code.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > 1. Connect Android devices (both wired and wireless)
  > 2. Run `flutter devices` to see connected devices
  > 3. Configure launch.json with device ID as shown in the example
  > 4. Attempt to run the application via VS Code debugger
  > 
  > Example `flutter devices` output:
  > ```
  > âžœ  ~ flutter devices
  > Found 4 connected devices:
  >   PLK110 (mobile) â€¢ 3B15AN013GM00000  â€¢ android-arm64  â€¢ Android 16 (API 36)
  >   PLK110 (mobile) â€¢ 10.205.1.239:5555 â€¢ android-arm64  â€¢ Android 16 (API 36)
  >   macOS (desktop) â€¢ macos             â€¢ darwin-arm64   â€¢ macOS 26.2 25C56
  >   darwin-arm64
  >   Chrome (web)    â€¢ chrome            â€¢ web-javascript â€¢ Google Chrome
  >   143.0.7499.169
  > ```
  > 
  > _(truncated)_

  * [#5728](https://github.com/Dart-Code/Dart-Code/issues/5728)/[#5880](https://github.com/Dart-Code/Dart-Code/issues/5880): When locating a Flutter SDK from a packages `.dart_tool/package_config.json` file, the `flutterRoot` field will be used in preference to inferring from the `flutter` package path.

  > **#5728**: Use `flutterRoot` instead of looking for the `flutter` package when reading the sdk path from `.package_config.json` `is enhancement`
  > **Is your feature request related to a problem? Please describe.**
  > Right now [`extractFlutterSdkPathFromPackagesFile`](https://github.com/Dart-Code/Dart-Code/blob/master/src/shared/utils/fs.ts#L228) tries to read the path to the "flutter" package and this works well for flutter projects, but does not work for pure dart projects.
  > 
  > **Describe the solution you'd like**
  > In ".package_config.json" there seem to be a field called "flutterRoot" which points to the sdk and is present regardless of the flutter package (and even created when running "dart pub get", though I have flutter installed on my device).
  > 
  > The URIs differ a bit, though:
  > 1. `"rootUri": "file://.../Desktop/flutter/packages/flutter",`
  > 2. `"flutterRoot": "file://.../Desktop/flutter",`
  > 
  > Maybe it's worth it to read the "flutterRoot" field instead?
  > 
  > **Describe alternatives you've considered**
  > _
  > 
  > **Additional context**
  > _




## Editor

  * [#5890](https://github.com/Dart-Code/Dart-Code/issues/5890): Changing the **Automatic Comment Slashes** setting now takes effect immediately without restarting VS Code.

  > **#5890**: Changes to `Automatic Comment Slashes` should be applied immediately `is enhancement` `in editor`
  > **Describe the bug**
  > Changing the value of `dart.automaticCommentSlashes` needs restarting the extension host.
  > 
  > **To Reproduce**
  > Steps to reproduce the behavior:
  > Open the settings and change the value of `dart.automaticCommentSlashes` to `all`, for example, and test it out. No changes to the behaviour happen.
  > 
  > **Expected behavior**
  > I expected this (and maybe other similar settings) could be automatically applied.
  > 
  > **Please complete the following information:**
  > 
  >   
  > 
  >   Workspace Environment
  > 
  >   ```text
  >   Dart Code extension: 3.127.20260121
  >   Flutter extension: 3.127.20251229 (activated)
  > 
  >   App: Visual Studio Code
  >   App Host: desktop
  >   Version: win 1.108.1
  > 
  >   Workspace type: Dart (LSP)
  >   Workspace name: bug
  > 
  >   Dart (3.12.0-edge.2bfdb03c4afd1592ca3c35bfa8e87c19a9db0c95): C:\Users\felip_0vh5fa6\dart
  >   Flutter (3.38.6): C:\Users\felip_0vh5fa6\.puro\envs\stable\flutter (No device)
  > 
  >   ```
  > 
  >   
  > 
  >   
  > 
  >   Output from 'dart info'
  > 
  >   `C:\Users\felip_0vh5fa6\dart\bin\dart.exe info`
  > 
  > _(truncated)_




## Debugging

  * [#5855](https://github.com/Dart-Code/Dart-Code/issues/5855)/[#5869](https://github.com/Dart-Code/Dart-Code/issues/5869): `launch.json` now accepts `debuggerType` to force the kind of debugger and provides code completion for the valid values. Generally the extension should correctly detect the correct kind of debugger to launch so use of this field is discouraged unless you have specific/unusual requirements.

  > **#5855**: Support (and document) launch config `debuggerType": 0` for both number and string `is enhancement` `in debugging` `in docs / website`
  > Given a workspace for the Dart SDK and the following lauch configurations for the debugger
  > 
  > ```json
  > 	"launch": {
  > 		"version": "0.2.0",
  > 		"configurations": [
  >                          {
  > 				"name": "dart pkg/compiler/test/record_use/record_use_test.dart",
  > 				"type": "dart",
  > 				"request": "launch",
  > 				"program": "pkg/compiler/test/record_use/record_use.dart", // works as expected
  > 				// "program": "pkg/compiler/test/record_use/record_use_dart.dart", // doesn't
  > 				"args": [
  > 					"types_of_arguments",
  > 				],
  > 				"cwd": "${workspaceFolder}",
  > 			},
  > ```
  > 
  > The behavior is different based on file name. It runs package test if the file is ending in `test.dart` even though this file has nothing to with package test. Leading to a crash that it cannot find a suite with such name.
  > 
  > Did we add some logic to simplify running tests in the debugger from launch configurations?
  > 
  > If yes, can we fix the heuristics? Or get a way to disable it?
  > 
  > _(truncated)_




## Tasks

  * [#5874](https://github.com/Dart-Code/Dart-Code/issues/5874)/[#5882](https://github.com/Dart-Code/Dart-Code/issues/5882): Tasks like `build_runner` are now invoked with `dart run`, preventing a warning about `flutter pub run` being deprecated.

  > **#5874**: Switch tasks from "dart pub run" and "flutter pub run" to "dart run", setting FLUTTER_ROOT if appropriate `is enhancement` `in tasks`
  > **Is your feature request related to a problem? Please describe.**
  > There is no immediate problem but is related to a deprecation. Since `flutter pub run` was deprecated in favor of `dart run`, the built in task command in the extension should be updated to use `dart run`.
  > 
  > **Describe the solution you'd like**
  > Update all following build tasks to use `dart run` instead
  > - `flutter: flutter pub run build_runner build`
  > - `flutter: flutter pub run build_runner watch`
  > - `flutter: flutter pub run build_runner serve`
  > 
  > **Describe alternatives you've considered**
  > No other alternatives considered.
  > 
  > **Additional context**
  > Output from running `flutter: flutter pub run build_runner build`:




## Misc

  * [#5886](https://github.com/Dart-Code/Dart-Code/issues/5886): Many skipped Dart-Code tests have been re-enabled with a workaround for VS Codeâ€™s behaviour of not firing document close events for up to three minutes after the editor was closed.

  > **#5886**: Add a workaround to force VS Code to trigger onDidCloseTextDocument `is testing`
  > We have code that handles closing and opening of text documents, but VS Code only actually closes them after 3 mins. Rather than have tests waiting for 3 mins or risking behaving differently to when files are really closed, this spawns dummy files that forces VS Code to clean up in places where we want to be sure that event fires.

  * [#5864](https://github.com/Dart-Code/Dart-Code/issues/5864): Dart-Code test coverage is now uploaded to Codecov as part of CI.
